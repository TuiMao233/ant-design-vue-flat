import{j as e,u as a,aN as l,B as o,aO as u,aP as s,aQ as t,c as d,i as r,aR as i,aS as n}from"./index.a53c91c6.js";import{a as c,e as m,l as p,m as v,b as g,o as b,c as f,g as w,t as _,u as y,s as h,F as V,P as k,k as x,p as q,X as A,h as U}from"./vendor.71e19cde.js";const C=x();q("data-v-59ec4f6a");const j={class:"title"},z={class:"oe-flex jump-box"},P=A("新增角色"),N=w("div",{class:"sides"},null,-1),B=A("刷新"),F={class:"oe-flex oe-row-center operation"},I=A("取消"),M=A(" 保存 "),O=A("新增");U();var Q=c({expose:[],setup(c){const x=e(),q=a(),A=m((()=>{var e;return void 0!==(null==(e=x.query)?void 0:e.id)})),U=p({account:"",name:"",verificationAccount:"",mobile:"",group_id:"",rules:[],password:""}),Q=p({name:"",explain:"",rules:[]}),R=(e,a)=>/^(?:(?:\+|00)86)?1[3-9]\d{9}$/.test(a),S={account:[{required:!0,message:"请输入员工账号",trigger:"blur"},{validator:R,message:"请输入正确的员工手机号",trigger:"blur"}],password:[{required:!0,message:"请输入登录密码",trigger:"blur"}],verificationAccount:[{required:!0,message:"请输入员工账号",trigger:"blur"}],name:[{required:!0,message:"请输入员工姓名",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],mobile:[{required:!0,message:"请输入员工手机号",trigger:"blur"},{validator:R,message:"请输入正确的员工手机号",trigger:"blur"}],group_id:[{required:!0,message:"请选择角色",trigger:"change"}]},X=p([]);l().then((e=>X.value=e.data.data));const $=async e=>{const{data:a}=await s(e);a.data.rules=a.data.rules.map((e=>Number(e))),Q.value=a.data};A.value&&(async()=>{const{data:e}=await u(x.query.id);U.value=e.data,U.value.password="","w7"===o.state.common.env&&(U.value.verificationAccount=e.data.username),$(e.data.group_id)})();const D=e=>$(e),E=p(),G=async()=>{await E.value.validate(),"w7"===o.state.common.env?await t({name:U.value.name,mobile:U.value.mobile,group_id:U.value.group_id,password:U.value.password,username:U.value.verificationAccount}):await t(U.value),d.success({type:"success",message:"添加成功!!",duration:1500}),await r(1500),q.back()},H=async()=>{await E.value.validate(),await i({id:x.query.id,name:U.value.name,mobile:U.value.mobile,group_id:U.value.group_id,password:U.value.password,username:U.value.verificationAccount}),d.success({type:"success",message:"修改成功!!",duration:1500}),await r(1500),q.back()},J=p([]),K=e=>{n({page:1,limit:1e4}).then((e=>{J.value=e.data.data.data})),e&&d.success("刷新成功!!")};return v((()=>K())),C(((e,a)=>{const l=g("el-input"),u=g("el-form-item"),s=g("el-option"),t=g("el-select"),d=g("el-button"),r=g("el-cascader-panel"),i=g("el-form"),n=g("el-card");return b(),f(i,{model:U.value,rules:S,ref:E,"label-width":"120px","label-position":"right"},{default:C((()=>[w(n,{shadow:"never",class:"custom-crad-container"},{header:C((()=>[w("div",j,_(y(A)?"编辑":"新增")+"员工",1)])),default:C((()=>["w7"===y(o).state.common.env?(b(),f(u,{key:0,label:"账号",prop:"verificationAccount"},{default:C((()=>[w(l,{modelValue:U.value.verificationAccount,"onUpdate:modelValue":a[1]||(a[1]=e=>U.value.verificationAccount=e),placeholder:"请输入账号"},null,8,["modelValue"])])),_:1})):(b(),f(u,{key:1,label:"账号",prop:"account"},{default:C((()=>[w(l,{disabled:y(A),modelValue:U.value.account,"onUpdate:modelValue":a[2]||(a[2]=e=>U.value.account=e),placeholder:"请输入账号"},null,8,["disabled","modelValue"])])),_:1})),"w7"!==y(o).state.common.env||y(x).query.id?h("",!0):(b(),f(u,{key:2,label:"登录密码",prop:"password"},{default:C((()=>[w(l,{modelValue:U.value.password,"onUpdate:modelValue":a[3]||(a[3]=e=>U.value.password=e),placeholder:"请输入登录密码","show-password":""},null,8,["modelValue"])])),_:1})),"w7"===y(o).state.common.env&&y(x).query.id?(b(),f(u,{key:3,label:"登录密码"},{default:C((()=>[w(l,{modelValue:U.value.password,"onUpdate:modelValue":a[4]||(a[4]=e=>U.value.password=e),placeholder:"请输入登录密码","show-password":""},null,8,["modelValue"])])),_:1})):h("",!0),w(u,{label:"角色",prop:"group_id"},{default:C((()=>[w(t,{modelValue:U.value.group_id,"onUpdate:modelValue":a[5]||(a[5]=e=>U.value.group_id=e),placeholder:"请选择角色",onChange:D},{default:C((()=>[(b(!0),f(V,null,k(J.value,(e=>(b(),f(s,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),w("div",z,[w(d,{type:"text",onClick:a[6]||(a[6]=e=>(e=>{const{href:a}=q.resolve({path:e});window.open(a,"_blank")})("/system/employeeAuthority/role-details"))},{default:C((()=>[P])),_:1}),N,w(d,{type:"text",onClick:a[7]||(a[7]=e=>K(!0))},{default:C((()=>[B])),_:1})])])),_:1}),w(i,{disabled:"","label-width":"120px","label-position":"right"},{default:C((()=>[w(u,{label:"权限说明"},{default:C((()=>[w(r,{props:{multiple:!0,emitPath:!1,label:"title",value:"id"},modelValue:Q.value.rules,"onUpdate:modelValue":a[8]||(a[8]=e=>Q.value.rules=e),options:X.value},null,8,["modelValue","options"])])),_:1})])),_:1}),w(u,{label:"员工姓名",prop:"name"},{default:C((()=>[w(l,{modelValue:U.value.name,"onUpdate:modelValue":a[9]||(a[9]=e=>U.value.name=e),placeholder:"请输入员工姓名"},null,8,["modelValue"])])),_:1}),w(u,{label:"员工联系方式",prop:"mobile"},{default:C((()=>[w(l,{modelValue:U.value.mobile,"onUpdate:modelValue":a[10]||(a[10]=e=>U.value.mobile=e),placeholder:"请输入员工联系方式"},null,8,["modelValue"])])),_:1})])),_:1}),w(n,{shadow:"never",class:"oe-m-t-15"},{default:C((()=>[w("div",F,[w(d,{size:"medium",onClick:a[11]||(a[11]=e=>y(q).replace("roleManage"))},{default:C((()=>[I])),_:1}),y(A)?(b(),f(d,{key:0,size:"medium",type:"primary",onClick:H},{default:C((()=>[M])),_:1})):(b(),f(d,{key:1,size:"medium",type:"primary",onClick:G},{default:C((()=>[O])),_:1}))])])),_:1})])),_:1},8,["model"])}))}});Q.__scopeId="data-v-59ec4f6a";export default Q;
