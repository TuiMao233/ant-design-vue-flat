import{L as e,M as a,N as o,q as l}from"./member.c7d788b5.js";import{u as t,j as s,L as n,c as d}from"./index.a53c91c6.js";import{i as c}from"./reset-time.7778decd.js";import{a as i,r as u,l as r,m,b as _,o as p,c as v,g as f,u as y,F as b,P as w,t as g,s as k,k as h,p as V,X as x,h as F}from"./vendor.71e19cde.js";const j=h();V("data-v-0fdfc9b4");const D={class:"create-label-box"},E=f("div",{class:"tips-tetx"},"满足以下任意条件即会自动给会员加上此标签",-1),U={class:"oe-flex"},z=x("元"),C=x("单"),q=x("元"),I=x("积分"),N=x("添加商品"),O={class:"item-left"},B={class:"item-right"},J={class:"commodity-name"},L={class:"commodity-price"},M=f("span",{class:"text"},"价格",-1),S={class:"price"},P={class:"commodity-stock"},X={class:"stock-left"},A=f("span",{class:"text"},"库存",-1),G={class:"stock"},H={class:"stock-right"},K=x("虚拟"),Q=x("卡密"),R=x("实体"),T=x("计时/次"),W=x("预约"),Y=x("批发"),Z={class:"oe-flex oe-row-center"},$=x("取消"),ee=x("保存");F();var ae=i({expose:[],setup(i){const h=t(),V=s(),x=u({name:[{required:!0,message:"请输入标签名称",trigger:"blur"}]}),F=r(),ae=r({name:"",remark:"",automatic:!0}),oe=r({total_order_num:"",total_order_amount:"",now_score:"",now_balance:""}),le=r(""),te=r([]),se=()=>{F.value.validate((e=>{e&&(async()=>{const e={name:ae.value.name,remark:ae.value.remark,is_need_condition:ae.value.automatic?"1":"0",condition_need:0,condition:""},l=[];if(ae.value.automatic){const a={total_order_num:1,total_order_amount:2,now_score:4,now_balance:8};Object.keys(oe.value).forEach((o=>{0!=oe.value[o]&&(e.condition_need+=a[o])})),te.value.length&&(te.value.forEach((e=>l.push(e.id))),e.condition_need+=16);const o=JSON.stringify({total_order_num:oe.value.total_order_num,total_order_amount:oe.value.total_order_amount,now_score:oe.value.now_score,now_balance:oe.value.now_balance,goods_ids:l});e.condition=o}else{const a=JSON.stringify({total_order_num:0,total_order_amount:0,now_score:0,now_balance:0,goods_ids:l});e.condition=a}le.value?(e.id=le.value,await o(e)):await a(e),d.success("操作成功"),h.go(-1)})()}))},ne=async()=>{const e=await n({option:{commodity:!0}});te.value.push(e.value.data)},de=async()=>{const{data:a}=await e({id:le.value}),o=a.data;ae.value.remark=o.remark,ae.value.name=o.name,ae.value.automatic=0!=o.is_need_condition,1==o.is_need_condition&&(o.condition.goods_ids.length&&o.condition.goods_ids.forEach((async e=>{const{data:a}=await l({id:e});te.value.push(a.data.data[0])})),oe.value.total_order_num=o.condition.total_order_num,oe.value.total_order_amount=o.condition.total_order_amount,oe.value.now_score=o.condition.now_score,oe.value.now_balance=o.condition.now_balance)};return m((()=>{V.query.id&&(le.value=V.query.id,de())})),j(((e,a)=>{const o=_("el-input"),l=_("el-form-item"),t=_("el-switch"),s=_("el-button"),n=_("el-image"),d=_("el-tag"),i=_("el-col"),u=_("el-row"),r=_("el-form"),m=_("el-card");return p(),v("div",D,[f(m,{shadow:"never",class:"content-box"},{default:j((()=>[f(r,{ref:F,model:ae.value,class:"adjust-form",rules:y(x),"label-width":"120px"},{default:j((()=>[f(l,{label:"标签名称",prop:"name"},{default:j((()=>[f(o,{class:"unified-inp",modelValue:ae.value.name,"onUpdate:modelValue":a[1]||(a[1]=e=>ae.value.name=e),placeholder:"请输入标签名称",maxlength:"5","show-word-limit":""},null,8,["modelValue"])])),_:1}),f(l,{label:"标签描述"},{default:j((()=>[f(o,{type:"textarea",modelValue:ae.value.remark,"onUpdate:modelValue":a[2]||(a[2]=e=>ae.value.remark=e),placeholder:"请输入标签描述",class:"unified-inp"},null,8,["modelValue"])])),_:1}),f(l,{label:"自动打标签"},{default:j((()=>[f(t,{modelValue:ae.value.automatic,"onUpdate:modelValue":a[3]||(a[3]=e=>ae.value.automatic=e)},null,8,["modelValue"]),E])),_:1}),1==ae.value.automatic?(p(),v(b,{key:0},[f("div",U,[f(l,{label:"累计消费金额"},{default:j((()=>[f(o,{modelValue:oe.value.total_order_amount,"onUpdate:modelValue":a[4]||(a[4]=e=>oe.value.total_order_amount=e),class:"appoint-inp",placeholder:"请输入累计消费金额",type:"number"},{append:j((()=>[z])),_:1},8,["modelValue"])])),_:1}),f(l,{label:"累计消费订单"},{default:j((()=>[f(o,{modelValue:oe.value.total_order_num,"onUpdate:modelValue":a[5]||(a[5]=e=>oe.value.total_order_num=e),modelModifiers:{number:!0},type:"number",class:"appoint-inp",placeholder:"请输入累计消费订单"},{append:j((()=>[C])),_:1},8,["modelValue"])])),_:1}),f(l,{label:"当前余额大于"},{default:j((()=>[f(o,{modelValue:oe.value.now_balance,"onUpdate:modelValue":a[6]||(a[6]=e=>oe.value.now_balance=e),class:"appoint-inp",placeholder:"请输入余额",type:"number",onInput:a[7]||(a[7]=e=>oe.value.now_balance=y(c)(oe.value.now_balance))},{append:j((()=>[q])),_:1},8,["modelValue"])])),_:1}),f(l,{label:"当前积分大于"},{default:j((()=>[f(o,{modelValue:oe.value.now_score,"onUpdate:modelValue":a[8]||(a[8]=e=>oe.value.now_score=e),class:"appoint-inp",placeholder:"请输入积分",type:"number",onInput:a[9]||(a[9]=e=>oe.value.now_score=y(c)(oe.value.now_score))},{append:j((()=>[I])),_:1},8,["modelValue"])])),_:1})]),f(l,{label:"购买指定商品"},{default:j((()=>[f(s,{type:"primary",onClick:ne},{default:j((()=>[N])),_:1})])),_:1}),f(u,{gutter:10,class:"commodity-box"},{default:j((()=>[(p(!0),v(b,null,w(te.value,((e,a)=>(p(),v(i,{key:a,xl:3,lg:5,md:6,sm:6,xs:6,class:"commodity-item"},{default:j((()=>[f("div",{class:["commodity-item-son",{"change-color":!0}]},[f("div",{class:"location-picture",onClick:e=>(e=>{te.value.splice(e,1)})(a)},[f(n,{src:"/addons/weitshop_shop/weshop/public/home/backend/images/member/wrong.png"})],8,["onClick"]),f("div",O,[f(n,{src:e.main_picture,class:"commodity-img"},null,8,["src"])]),f("div",B,[f("div",J,g(e.title),1),f("div",L,[M,f("span",S,"¥"+g(e.price),1)]),f("div",P,[f("div",X,[A,f("span",G,g(e.stock),1)]),f("div",H,["2"==e.goods_type?(p(),v(d,{key:0,size:"mini",color:"#D4EBFF",style:{color:"#55adff"}},{default:j((()=>[K])),_:1})):k("",!0),"3"==e.goods_type?(p(),v(d,{key:1,size:"mini",color:"#FBDDD1",style:{color:"#ec672e"}},{default:j((()=>[Q])),_:1})):k("",!0),"1"==e.goods_type?(p(),v(d,{key:2,size:"mini",color:"#E4FFF8",style:{color:"#1ad370"}},{default:j((()=>[R])),_:1})):k("",!0),"4"==e.goods_type?(p(),v(d,{key:3,size:"mini",color:"#F4DFD3",style:{color:"#ef864c"}},{default:j((()=>[T])),_:1})):k("",!0),"5"==e.goods_type?(p(),v(d,{key:4,size:"mini",color:"#F8E8CF",style:{color:"#dd8a0d"}},{default:j((()=>[W])),_:1})):k("",!0),"6"==e.goods_type?(p(),v(d,{key:5,size:"mini",color:"#E9D4F9",style:{color:"#8f29df"}},{default:j((()=>[Y])),_:1})):k("",!0)])])])])])),_:2},1024)))),128))])),_:1})],64)):k("",!0)])),_:1},8,["model","rules"])])),_:1}),f(m,{shadow:"never",class:"operation-box"},{default:j((()=>[f("div",Z,[f(s,{onClick:a[10]||(a[10]=e=>y(h).go(-1))},{default:j((()=>[$])),_:1}),f(s,{type:"primary",onClick:se},{default:j((()=>[ee])),_:1})])])),_:1})])}))}});ae.__scopeId="data-v-0fdfc9b4";export default ae;
