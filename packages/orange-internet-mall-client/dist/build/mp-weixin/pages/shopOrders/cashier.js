(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shopOrders/cashier"],{"2b17":function(e,t,n){},"2da6":function(e,t,n){"use strict";n.r(t);var r=n("fef0"),o=n("57b3");for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("f4df");var u,i=n("f0c5"),c=Object(i["a"])(o["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],u);t["default"]=c.exports},"57b3":function(e,t,n){"use strict";n.r(t);var r=n("98ce"),o=n.n(r);for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);t["default"]=o.a},9293:function(e,t,n){"use strict";(function(e){n("6cdc");var t=r(n("2da6"));function r(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},"98ce":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=d(n("4795")),o=n("79f6"),a=d(n("0613")),u=n("d257"),i=n("a6f4"),c=d(n("66fd"));function d(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(d){return void n(d)}i.done?t(c):Promise.resolve(c).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function u(e){s(a,r,o,u,i,"next",e)}function i(e){s(a,r,o,u,i,"throw",e)}u(void 0)}))}}var f=c.default.extend({props:{},components:{},data:function(){return{type:"BalancePay",order:{},listPay:[],payPrice:"",ids:""}},computed:{},methods:{getPayTypeIcon:function(e){var t={WxPay:{text:"微信支付",icon:"weixin-circle-fill",color:"#41B035"},AliPay:{text:"支付宝",icon:"zhifubao-circle-fill",color:"#108EE9"},BalancePay:{text:"余额支付",icon:"rmb-circle",color:"#FE9B2A"}};return t[e]},getOrderDetial:function(e){var t=this;return l(r.default.mark((function n(){var a,u;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,o.reqGetOrderDetial)(e);case 2:a=n.sent,u=a.data,t.order=u.data.order[0],console.log(t.order);case 6:case"end":return n.stop()}}),n)})))()},getPaymentTypes:function(){var e=this;return l(r.default.mark((function t(){var n,a;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,o.reqGetPayMethod)();case 2:n=t.sent,a=n.data,e.listPay=a.data.map((function(t){return t.showInfo=e.getPayTypeIcon(t.pay_code),t}));case 5:case"end":return t.stop()}}),t)})))()},onWeChatPayment:function(t){var n=this;e.requestPayment({timeStamp:t.timestamp,nonceStr:t.nonce_str,package:"prepay_id="+t.prepay_id,signType:"MD5",paySign:t.paySign,success:function(){var e=l(r.default.mark((function e(){return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,u.showToast)({title:"支付成功!",mask:!0});case 2:n.$redirectTo("/pages/shopOrders/paymentSuccessful",{ids:n.ids});case 3:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()})},onAlipayPayment:function(e){var t=document.getElementsByTagName("divform");t.length&&document.body.removeChild(t[0]);var n=document.createElement("divform");n.innerHTML=e,document.body.appendChild(n),document.getElementById("alipay_submit").submit(),this.$redirectTo("/pages/shopOrders/paymentSuccessful",{ids:this.ids})},onClickPaymentSubmit:function(){var e=this;return l(r.default.mark((function t(){var n,i;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,o.reqToPay)(e.ids,e.type);case 2:if(n=t.sent,i=n.data,"BalancePay"!=e.type){t.next=9;break}return t.next=7,(0,u.showToast)({title:"支付成功"});case 7:a.default.dispatch("getMoney"),e.$redirectTo("/pages/shopOrders/paymentSuccessful",{ids:e.ids});case 9:if("url"!=i.data.type){t.next=13;break}return location.href=i.data.data,e.$redirectTo("/pages/shopOrders/myOrders",{id:0}),t.abrupt("return",!1);case 13:"data"==i.data.type&&(i.data.data.timestamp=i.timestamp.toString(),e.onWeChatPayment(i.data.data)),"form"==i.data.type&&e.onAlipayPayment(i.data.data);case 15:case"end":return t.stop()}}),t)})))()}},watch:{},setup:function(){var e=(0,i.computed)((function(){return a.default.getters.hexColor}));return{$hexColor:e}},onLoad:function(e){void 0!=e.orderInfo?(this.ids=JSON.parse(decodeURIComponent(e.orderInfo)).id,this.payPrice=JSON.parse(decodeURIComponent(e.orderInfo)).payPrice):(this.ids=e.id,this.getOrderDetial(e.id)),this.getPaymentTypes()},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){e.stopPullDownRefresh()},onReachBottom:function(){}});t.default=f}).call(this,n("543d")["default"])},f4df:function(e,t,n){"use strict";var r=n("2b17"),o=n.n(r);o.a},fef0:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return r}));var r={uCard:function(){return n.e("node-modules/uview-ui/components/u-card/u-card").then(n.bind(null,"d505"))},uIcon:function(){return n.e("node-modules/uview-ui/components/u-icon/u-icon").then(n.bind(null,"f86b"))},uCheckbox:function(){return n.e("node-modules/uview-ui/components/u-checkbox/u-checkbox").then(n.bind(null,"1e79"))},unionBlank:function(){return n.e("components/unions/union-blank").then(n.bind(null,"2902"))},customFixedFooter:function(){return n.e("components/customs/custom-fixed-footer").then(n.bind(null,"707a"))},uButton:function(){return n.e("node-modules/uview-ui/components/u-button/u-button").then(n.bind(null,"d9ad"))}},o=function(){var e=this,t=e.$createElement,n=(e._self._c,(e.order||e.payPrice)&&e.payPrice?Number(e.payPrice).toFixed(2):null),r=(e.order||e.payPrice)&&e.order.total_fee?Number(e.order.total_fee).toFixed(2):null,o=e.order||e.payPrice?{background:e.$hexColor["--color-primary"]}:null;e._isMounted||(e.e0=function(t,n){var r=arguments[arguments.length-1].currentTarget.dataset,o=r.eventParams||r["event-params"];n=o.item;e.type=n.pay_code}),e.$mp.data=Object.assign({},{$root:{g0:n,g1:r,a0:o}})},a=[]}},[["9293","common/runtime","common/vendor"]]]);