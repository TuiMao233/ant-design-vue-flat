(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shopOrders/orderDetails"],{"18a6":function(e,r,t){"use strict";t.r(r);var n=t("a240"),o=t("8b4b");for(var i in o)["default"].indexOf(i)<0&&function(e){t.d(r,e,(function(){return o[e]}))}(i);t("30e9");var a,u=t("f0c5"),c=Object(u["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],a);r["default"]=c.exports},1962:function(e,r,t){"use strict";(function(e){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(t("4795")),o=t("d257"),i=s(t("5a0c")),a=s(t("d772")),u=t("79f6"),c=t("a6f4"),d=s(t("0613"));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,r,t,n,o,i,a){try{var u=e[i](a),c=u.value}catch(d){return void t(d)}u.done?r(c):Promise.resolve(c).then(n,o)}function f(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var i=e.apply(r,t);function a(e){l(i,n,o,a,u,"next",e)}function u(e){l(i,n,o,a,u,"throw",e)}a(void 0)}))}}i.default.extend(a.default);var m=(0,c.defineComponent)({components:{},props:{},data:function(){return{id:0,order:{},logisticsInfo:[],config:{},addressDetail:{},timestamp:0,timer:0,durationsText:""}},computed:{durations:function(){var e=i.default.duration(this.timestamp);return e.$d}},setup:function(){var e=(0,c.computed)((function(){return d.default.getters.hexColor})),r=(0,c.computed)((function(){return"1"==d.default.state.common.commentSet.is_open_comment}));return{$hexColor:e,is_open_comment:r}},methods:{getOrderInfo:function(e){var r=this;return f(n.default.mark((function t(){var o,i,a,c;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,u.reqGetOrderDetial)(e);case 2:o=t.sent,i=o.data,r.order=i.data.order[0],r.config=i.data.config,clearInterval(r.timer),2==r.order.status&&(a=r.countDown(r.order.shipments_time,r.config.affirmTakeDeliveryTime.value,"day"),r.durationsText="".concat(a.leftd,"天").concat(a.lefth,"小时").concat(a.leftm,"分钟"),r.timer=setInterval(f(n.default.mark((function e(){var t;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=r.countDown(r.order.shipments_time,r.config.affirmTakeDeliveryTime.value,"day"),!(t.endTime<=0&&1==r.config.affirmTakeDeliveryTime.type)){e.next=5;break}return e.next=4,(0,u.reqConfirmReceipt)(r.order.id);case 4:clearInterval(r.timer);case 5:r.durationsText="".concat(t.leftd,"天").concat(t.lefth,"小时").concat(t.leftm,"分钟");case 6:case"end":return e.stop()}}),e)}))),6e4)),0==r.order.status&&(c=r.countDown(r.order.createtime,r.config.cancelOrder.value,"m"),r.durationsText="".concat(c.lefth,"小时").concat(c.leftm,"分").concat(c.lefts,"秒"),r.timer=setInterval((function(){var e=r.countDown(r.order.createtime,r.config.cancelOrder.value,"m");e.endTime<=0&&1==r.config.cancelOrder.type&&(clearInterval(r.timer),(0,u.reqCancelOrder)(r.order.id)),r.durationsText="".concat(e.lefth,"小时").concat(e.leftm,"分").concat(e.lefts,"秒")}),1e3));case 9:case"end":return t.stop()}}),t)})))()},countDown:function(e,r,t){var n=(0,i.default)(1e3*e).add(Number(r),t).unix()-(0,i.default)().unix();return n<=0&&clearInterval(this.timer),{leftd:Math.floor(n/86400),lefth:Math.floor(n/3600%24),leftm:Math.floor(1e3*n/6e4%60),lefts:Math.floor(1e3*n/1e3%60),endTime:n}},getLogiStics:function(){var e=this;return f(n.default.mark((function r(){var t,o;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,(0,u.reqSeeLogiStics)(e.order.id);case 2:t=r.sent,o=t.data,e.logisticsInfo=o.data;case 5:case"end":return r.stop()}}),r)})))()},confirmGoods:function(){var r=this;return f(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.showModal({title:"确认收货",content:"您确认收货吗？",success:function(){var e=f(n.default.mark((function e(t){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.confirm){e.next=6;break}return e.next=3,(0,u.reqConfirmReceipt)(r.order.id);case 3:return e.next=5,(0,o.showToast)({icon:"none",title:"确认收货成功"});case 5:r.$navigateBack();case 6:case"end":return e.stop()}}),e)})));function t(r){return e.apply(this,arguments)}return t}()});case 1:case"end":return t.stop()}}),t)})))()},applyRefund:function(e){var r=this;return f(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r.$navigateTo("/pages/shopOrders/selectAfterSaleType",{goodsId:e.goods_id,goodsOrderId:e.id,orderId:r.order.id});case 1:case"end":return t.stop()}}),t)})))()},cancelOrder:function(){var r=this;return f(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.showModal({title:"取消订单",content:"您确认取消该订单吗？",success:function(){var e=f(n.default.mark((function e(t){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.confirm){e.next=6;break}return e.next=3,(0,u.reqCancelOrder)(r.order.id);case 3:return e.next=5,(0,o.showToast)({icon:"none",title:"取消订单成功"});case 5:r.$navigateBack();case 6:case"end":return e.stop()}}),e)})));function t(r){return e.apply(this,arguments)}return t}()});case 1:case"end":return t.stop()}}),t)})))()},evaluate:function(){(0,o.navigateTo)("/pages/shopOrders/commodityEvaluation",{id:this.id})},addShopCart:function(e){var r=this;return f(n.default.mark((function t(){var i;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=[],r.logisticsInfo.forEach((function(e){e.goods.forEach((function(e){i.push({goods_id:e.goods_id,sku_id:e.goods_sku_id,num:e.goods_num,price:e.goods_price})}))})),t.next=4,(0,u.reqAddCartLists)(i);case 4:e||(0,o.showToast)({title:"加入购物车成功"});case 5:case"end":return t.stop()}}),t)})))()},buyAgain:function(){var e=this;return f(n.default.mark((function r(){var t,o;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t=!0,r.next=3,e.addShopCart(t);case 3:o=[],e.logisticsInfo.forEach((function(e){e.goods.forEach((function(e){o.push(e.goods_id)}))})),e.$navigateTo("/pages/baseTabBars/shopCart",{ids:JSON.stringify(o)});case 6:case"end":return r.stop()}}),r)})))()},editAddress:function(e){var r=this;return f(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,u.reqEditOrderAddress)({id:r.order.id,phone:e.phone,consignee:e.consignee,province_name:e.province_name,city_name:e.city_name,area_name:e.area_name,address:e.address,province_id:e.province_id,city_id:e.city_id,area_id:e.area_id});case 2:r.getOrderInfo(r.order.id);case 3:case"end":return t.stop()}}),t)})))()}},watch:{},onLoad:function(r){var t=this;return f(n.default.mark((function o(){return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.id=r.id,n.next=3,t.getOrderInfo(r.id);case 3:return n.next=5,t.getLogiStics();case 5:e.$on("address-select",t.editAddress);case 6:case"end":return n.stop()}}),o)})))()},onReady:function(){},onShow:function(){var e=this;return f(n.default.mark((function r(){return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if("undefined"===typeof e.order.id){r.next=5;break}return r.next=3,e.getOrderInfo(e.order.id);case 3:return r.next=5,e.getLogiStics();case 5:case"end":return r.stop()}}),r)})))()},onHide:function(){},onUnload:function(){e.$off("address-select",this.editAddress)},onPullDownRefresh:function(){e.stopPullDownRefresh()},onReachBottom:function(){}});r.default=m}).call(this,t("543d")["default"])},"30e9":function(e,r,t){"use strict";var n=t("7613"),o=t.n(n);o.a},7613:function(e,r,t){},"8b4b":function(e,r,t){"use strict";t.r(r);var n=t("1962"),o=t.n(n);for(var i in n)["default"].indexOf(i)<0&&function(e){t.d(r,e,(function(){return n[e]}))}(i);r["default"]=o.a},a240:function(e,r,t){"use strict";t.d(r,"b",(function(){return o})),t.d(r,"c",(function(){return i})),t.d(r,"a",(function(){return n}));var n={uIcon:function(){return t.e("node-modules/uview-ui/components/u-icon/u-icon").then(t.bind(null,"f86b"))},viewIcon:function(){return Promise.all([t.e("common/vendor"),t.e("components/view/view-icon")]).then(t.bind(null,"2807"))},uCard:function(){return t.e("node-modules/uview-ui/components/u-card/u-card").then(t.bind(null,"d505"))},uTimeLine:function(){return t.e("node-modules/uview-ui/components/u-time-line/u-time-line").then(t.bind(null,"34f4"))},uTimeLineItem:function(){return t.e("node-modules/uview-ui/components/u-time-line-item/u-time-line-item").then(t.bind(null,"87b7"))},commonOrderShopList:function(){return t.e("components/commons/common-order-shop-list").then(t.bind(null,"3013"))},customFixedFooter:function(){return t.e("components/customs/custom-fixed-footer").then(t.bind(null,"707a"))},uButton:function(){return t.e("node-modules/uview-ui/components/u-button/u-button").then(t.bind(null,"d9ad"))}},o=function(){var e=this,r=e.$createElement,t=(e._self._c,2==e.order.status?encodeURIComponent(JSON.stringify(e.order)):null),n=3==e.order.status?encodeURIComponent(JSON.stringify(e.order)):null,o=e.order.order_sn?e.__map(e.logisticsInfo,(function(r,t){var n=e.__get_orig(r),o=2==e.order.status?e.__map(r.logistics.info.data,(function(r,t){var n=e.__get_orig(r),o=Number(t);return{$orig:n,m0:o}})):null,i=2==e.order.status?encodeURIComponent(JSON.stringify(e.logisticsInfo[t])):null,a=3==e.order.status?encodeURIComponent(JSON.stringify(e.logisticsInfo[t])):null;return{$orig:n,l0:o,m1:i,m3:a}})):null,i=e.order.order_sn?e.$formatUnix(e.order.createtime):null,a=e.order.order_sn&&-1!=e.order.status&&0!=e.order.status?e.$formatUnix(e.order.paytime):null,u=e.order.order_sn&&0==e.order.status?{background:e.$hexColor["--color-primary-light-9"]+" !important",borderColor:e.$hexColor["--color-primary"]+" !important",color:e.$hexColor["--color-primary"]+" !important"}:null,c=e.order.order_sn&&1==e.order.status?{background:e.$hexColor["--color-primary-light-9"]+" !important",borderColor:e.$hexColor["--color-primary"]+" !important",color:e.$hexColor["--color-primary"]+" !important"}:null,d=e.order.order_sn&&2==e.order.status?{background:e.$hexColor["--color-primary-light-9"]+" !important",borderColor:e.$hexColor["--color-primary"]+" !important",color:e.$hexColor["--color-primary"]+" !important"}:null,s=e.order.order_sn&&3==e.order.status?e.order.orderGoods.some((function(e){return 0==e.comment_status})):null,l=e.order.order_sn&&3==e.order.status&&s&&e.is_open_comment&&2!=e.order.type?{background:e.$hexColor["--color-primary-light-9"]+" !important",borderColor:e.$hexColor["--color-primary"]+" !important",color:e.$hexColor["--color-primary"]+" !important"}:null,f=e.order.order_sn&&-1==e.order.status?{background:e.$hexColor["--color-primary-light-9"]+" !important",borderColor:e.$hexColor["--color-primary"]+" !important",color:e.$hexColor["--color-primary"]+" !important"}:null;e.$mp.data=Object.assign({},{$root:{m2:t,m4:n,l1:o,m5:i,m6:a,a0:u,a1:c,a2:d,g0:s,a3:l,a4:f}})},i=[]},ad01:function(e,r,t){"use strict";(function(e){t("6cdc");var r=n(t("18a6"));function n(e){return e&&e.__esModule?e:{default:e}}e(r.default)}).call(this,t("543d")["createPage"])}},[["ad01","common/runtime","common/vendor"]]]);