import{u as e,a,c as l}from"./index.a53c91c6.js";import{j as r,k as t}from"./finance.2ba7f690.js";import{a as s,l as o,r as u,w as d,m as n,b as i,o as c,c as p,g as v,F as m,P as _,u as g,t as f,X as y,s as b,k as w,p as h,h as x,d as k}from"./vendor.71e19cde.js";import{r as T,d as C}from"./member.c7d788b5.js";const V=w();h("data-v-d44c9a10");const z={class:"oe-flex is-grid"},N=v("div",{class:"screen-text"},"关键信息",-1),S={class:"oe-flex is-grid"},U=v("div",{class:"screen-text"},"会员等级",-1),j={class:"oe-flex is-grid"},P=v("div",{class:"screen-text"},"操作人",-1),E={class:"oe-flex is-grid"},q=v("div",{class:"screen-text"},"类型",-1),F={class:"oe-flex is-grid"},I=v("div",{class:"screen-text"},"操作时间",-1),L={class:"oe-flex is-grid"},R=y("搜索"),A=y("导出报表"),B={class:"oe-flex"},D={class:"member-text"},O={key:0},X={key:1},G={key:2},H={key:3},J={key:4},K={key:5},M={key:6},Q={key:0},W={key:1},Y={key:2},Z={key:0,class:"profit"},$={key:1,class:"expenditure"},ee=y("查看 "),ae=y("备注 "),le={key:0,class:"noter-text"},re={key:1,class:"noter-text"},te={class:"dialog-footer"},se=y("取消"),oe=y("确定");x();var ue=s({expose:[],setup(s){const w=e(),{pagination:h,handleSizeChange:x,handleCurrentChange:ue}=a(),de=o({cruxName:"",grade:"",operator:"",waterType:"",waterTime:""}),ne=o({cruxName:"",grade:"",operator:"",waterType:"",waterTime:""}),ie=o([]),ce=o(""),pe=o(!1),ve=o([]),me=o([]),_e=u([{value:"1",label:"订单支付"},{value:"2",label:"会员充值"},{value:"3",label:"商家取消订单退款"},{value:"4",label:"余额提现"},{value:"5",label:"后台充值"},{value:"6",label:"维权退款"}]);T({page:1,limit:100}).then((e=>{ve.value=e.data.data.data})),C({page:1,limit:100}).then((e=>{ie.value=e.data.data.data}));const ge=()=>{ne.value.cruxName=de.value.cruxName,ne.value.grade=de.value.grade,ne.value.operator=de.value.operator,ne.value.waterType=de.value.waterType,ne.value.waterTime=de.value.waterTime,h.currentPage=1,be()},fe=()=>{de.value.cruxName="",de.value.grade="",de.value.operator="",de.value.waterType="",de.value.waterTime="",ge()},ye=async()=>{let e="";ne.value.waterTime&&(e=k(ne.value.waterTime).unix().toString());const{data:a}=await r({page:h.currentPage,limit:h.pageSize,search:{search:ne.value.cruxName,current_shop_user_level_id:ne.value.grade,type:ne.value.waterType,change_user_type:ne.value.operator,add_time:e}});if(me.value.length){const e=new Blob([a]),l=window.URL.createObjectURL(e),r=document.createElement("a");r.style.display="none",r.href=l,r.setAttribute("download","余额.xlsx"),document.body.appendChild(r),r.click()}else l("暂无导出的数据！")};d([()=>h.currentPage,()=>h.pageSize],(()=>{be()}));const be=async()=>{let e="";de.value.waterTime&&(e=k(de.value.waterTime).unix().toString());const{data:a}=await t({page:h.currentPage,limit:h.pageSize,search:{search:de.value.cruxName,current_shop_user_level_id:de.value.grade,type:de.value.waterType,change_user_type:de.value.operator,add_time:e}});h.total=a.data.total,me.value=a.data.data,me.value.forEach((e=>{e.balance_change=Number(e.balance_change),e.after_balance=Number(e.after_balance)}));for(let l=0;l<me.value.length;l++)for(let e=0;e<ve.value.length;e++)me.value[l].user.user_channel_name==ve.value[e].code&&(me.value[l].img_url=ve.value[e].img_url)};return n((()=>be())),V(((e,a)=>{const l=i("el-input"),r=i("el-col"),t=i("el-option"),s=i("el-select"),o=i("el-date-picker"),u=i("el-button"),d=i("el-row"),n=i("el-card"),k=i("el-empty"),T=i("el-image"),C=i("el-table-column"),ne=i("custom-button"),ve=i("el-table"),be=i("el-pagination"),we=i("el-dialog");return c(),p(m,null,[v(n,{shadow:"never",class:"screen-box"},{default:V((()=>[v(d,{gutter:24},{default:V((()=>[v(r,{xl:{span:"4_8"},md:8,sm:12,class:"oe-flex"},{default:V((()=>[v("div",z,[N,v(l,{class:"oe-flex-1",modelValue:de.value.cruxName,"onUpdate:modelValue":a[1]||(a[1]=e=>de.value.cruxName=e),onInput:ge,placeholder:"昵称/姓名/手机号"},null,8,["modelValue"])])])),_:1}),v(r,{xl:{span:"4_8"},md:8,sm:12,class:"oe-flex"},{default:V((()=>[v("div",S,[U,v(s,{modelValue:de.value.grade,"onUpdate:modelValue":a[2]||(a[2]=e=>de.value.grade=e),placeholder:"全部",class:"oe-flex-1",clearable:""},{default:V((()=>[v(t,{label:"全部",value:" "}),(c(!0),p(m,null,_(ie.value,(e=>(c(),p(t,{label:e.level_name,value:e.id,key:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])),_:1}),v(r,{xl:{span:"4_8"},md:8,sm:12,class:"oe-flex"},{default:V((()=>[v("div",j,[P,v(s,{modelValue:de.value.operator,"onUpdate:modelValue":a[3]||(a[3]=e=>de.value.operator=e),placeholder:"全部",class:"oe-flex-1",clearable:""},{default:V((()=>[v(t,{label:"会员本人",value:"1"}),v(t,{label:"其他角色",value:"2"}),v(t,{label:"超管",value:"3"})])),_:1},8,["modelValue"])])])),_:1}),v(r,{xl:{span:"4_8"},md:8,sm:12,class:"oe-flex"},{default:V((()=>[v("div",E,[q,v(s,{modelValue:de.value.waterType,"onUpdate:modelValue":a[4]||(a[4]=e=>de.value.waterType=e),placeholder:"全部",class:"oe-flex-1",clearable:""},{default:V((()=>[(c(!0),p(m,null,_(g(_e),(e=>(c(),p(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])),_:1}),v(r,{xl:{span:"4_8"},md:8,sm:12,class:"oe-flex"},{default:V((()=>[v("div",F,[I,v(o,{class:"oe-flex-1",modelValue:de.value.waterTime,"onUpdate:modelValue":a[5]||(a[5]=e=>de.value.waterTime=e),type:"date",placeholder:"选择操作时间"},null,8,["modelValue"])])])),_:1}),v(r,{xl:{span:"4_8"},md:8,sm:12,class:"oe-flex"},{default:V((()=>[v("div",L,[v(u,{type:"primary",size:"small",onClick:ge},{default:V((()=>[R])),_:1}),v("div",{class:"reset-text",onClick:fe},"重置条件")])])),_:1})])),_:1})])),_:1}),v(n,{shadow:"never",class:"water-list custom-crad-container custom-card-page"},{default:V((()=>[v(u,{type:"primary",size:"small",onClick:ye},{default:V((()=>[A])),_:1}),v(ve,{class:"revenue-list",data:me.value,style:{width:"100%"}},{empty:V((()=>[v(k,{class:"oe-m-t-30",description:"暂无余额流水"})])),default:V((()=>[v(C,{prop:"date",label:"会员","min-width":"150"},{default:V((e=>[v("div",B,[v(T,{src:e.row.user.avatar,class:"member-img"},null,8,["src"]),v("div",null,[v("div",D,f(e.row.user.nickname),1),v(T,{src:e.row.img_url,class:"platform-img"},null,8,["src"])])])])),_:1}),v(C,{prop:"name",label:"会员等级","min-width":"70"},{default:V((e=>[y(f(e.row.user.current_shop_user_level_name),1)])),_:1}),v(C,{prop:"name",label:"手机号","min-width":"80"},{default:V((e=>[v("div",null,f(e.row.user.mobile),1)])),_:1}),v(C,{prop:"address",label:"类型"},{default:V((e=>["1"==e.row.type?(c(),p("div",O,"订单支付")):b("",!0),"2"==e.row.type?(c(),p("div",X,"会员充值")):b("",!0),"3"==e.row.type?(c(),p("div",G,"商家取消订单退款")):b("",!0),"4"==e.row.type?(c(),p("div",H,"余额提现")):b("",!0),"5"==e.row.type?(c(),p("div",J,"后台充值")):b("",!0),"6"==e.row.type?(c(),p("div",K,"维权退款")):b("",!0),"7"==e.row.type?(c(),p("div",M,"拒绝提现")):b("",!0)])),_:1}),v(C,{prop:"address",label:"操作人"},{default:V((e=>["1"==e.row.change_user_type?(c(),p("div",Q,"会员本人")):b("",!0),"2"==e.row.change_user_type?(c(),p("div",W,"其他角色")):b("",!0),"3"==e.row.change_user_type?(c(),p("div",Y,"超管")):b("",!0)])),_:1}),v(C,{prop:"add_time_text",label:"时间","min-width":"90",sortable:""}),v(C,{prop:"balance_change",label:"余额变化",sortable:""},{default:V((e=>[e.row.balance_change>=0?(c(),p("div",Z," ¥"+f(e.row.balance_change),1)):(c(),p("div",$," ¥"+f(e.row.balance_change),1))])),_:1}),v(C,{prop:"after_balance",label:"当前余额",sortable:""},{default:V((e=>[v("div",null,"¥"+f(e.row.after_balance),1)])),_:1}),v(C,{prop:"address",label:"操作"},{default:V((e=>[1==e.row.type||3==e.row.type||6==e.row.type?(c(),p(ne,{key:0,icon:"ad-see",color:"#FE6712",onClick:a=>{return l=e.row,void("1"==(r=e.row.type)?w.push({path:"/order/management/all-orders",query:{system_order_no:l.business_id}}):"3"==r?w.push({path:"/order/management/orderDetails",query:{id:l.id}}):w.push({path:"/order/management/protection-details",query:{id:l.order_id,orderId:l.business_id}}));var l,r}},{default:V((()=>[ee])),_:2},1032,["onClick"])):(c(),p(ne,{key:1,icon:"ad-remarks",color:"#FE6712",onClick:a=>{return l=e.row.remark,ce.value=l,void(pe.value=!0);var l}},{default:V((()=>[ae])),_:2},1032,["onClick"]))])),_:1})])),_:1},8,["data"]),v(r,{lg:24,class:"paging-box"},{default:V((()=>[v(be,{class:"e-grid","page-sizes":g(h).pageSizes,"page-size":g(h).pageSize,background:"","current-page":g(h).currentPage,layout:"total, prev, pager, next,sizes, jumper",total:g(h).total,onSizeChange:g(x),onCurrentChange:g(ue)},null,8,["page-sizes","page-size","current-page","total","onSizeChange","onCurrentChange"])])),_:1})])),_:1}),v(we,{title:"备注",modelValue:pe.value,"onUpdate:modelValue":a[8]||(a[8]=e=>pe.value=e),width:"554px"},{footer:V((()=>[v("span",te,[v(u,{onClick:a[6]||(a[6]=e=>pe.value=!1)},{default:V((()=>[se])),_:1}),v(u,{type:"primary",onClick:a[7]||(a[7]=e=>pe.value=!1)},{default:V((()=>[oe])),_:1})])])),default:V((()=>[ce.value?(c(),p("div",le,f(ce.value),1)):(c(),p("div",re,"暂无"))])),_:1},8,["modelValue"])],64)}))}});ue.__scopeId="data-v-d44c9a10";export default ue;
