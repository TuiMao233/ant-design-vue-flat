import{a as e,b as a,o as l,c as t,F as s,g as i,t as u,s as c,k as o,p as d,h as n,l as r,e as p,w as v,P as m,X as y,u as g,f as _,r as f,m as x,Z as h,G as k}from"./vendor.71e19cde.js";import{x as b,$ as w,i as C,y as V,a as z,z as S,A as j,B as P,f as U,C as T,D as N,c as D,E as B,F as q,G as I,_ as M,H as A,I as F,J as $}from"./index.a53c91c6.js";import{u as G}from"./use-grid-detector.bb68f42c.js";const K=o();d("data-v-5a69a8d5");const W={class:"oe-flex oe-row-center"},E={class:"price-container"},H={class:"text oe-m-b-10"},J=i("div",{class:"tips"},"请使用微信扫码支付",-1),L=i("div",{class:"grey-tips"},"支付后关闭弹窗等待确认订单状态",-1);n();var O=e({expose:[],props:{code:{type:String,required:!0},type:{type:String},data:{type:String},price:{type:String}},setup:e=>K(((o,d)=>{const n=a("qr-code");return l(),t("div",W,["WxPay"===e.code?(l(),t(s,{key:0},[i(n,{size:101,text:e.data,margin:15},null,8,["text"]),i("div",E,[i("div",H,u(e.price),1),J,L])],64)):c("",!0),"AliPay"===e.code?(l(),t(s,{key:1},[],64)):c("",!0)])}))});O.__scopeId="data-v-5a69a8d5";const R=o();d("data-v-7cbee10c");const X={class:"oe-flex extend-box"},Z={class:"text"},Q={class:"money"},Y=y("点击进行购买"),ee={class:"purchase-box"},ae={key:0,style:{"text-align":"center"}},le=i("div",{class:"purchase-title"},"购买成功",-1),te={key:1,style:{"text-align":"center"}},se=i("div",{class:"purchase-title"},"订单自动过期",-1),ie={key:2,style:{"text-align":"center"}},ue=i("div",{class:"purchase-title"},"未支付",-1),ce={class:"purchase-price"},oe=y("确定");n();var de=e({expose:[],props:{show:{type:Boolean,required:!0},mealData:{type:Object,required:!0}},setup(e,{emit:o}){const d=e,n=r([{key:"AliPay",name:"支付宝"},{key:"WxPay",name:"微信"}]),f=r({code:"AliPay",capacity_item_id:"",capacity_id:"",price:""}),x=r(!1),h=r({}),k=r(),z=async()=>{const{data:e}=await b({code:f.value.code,capacity_item_id:f.value.capacity_item_id,capacity_id:f.value.capacity_id});k.value=e.data},S=async()=>{const e=w.service({background:"rgba(0,0,0,0.1)",text:"拼命加载中....",spinner:"el-icon-loading"});await C(5e3);const{data:a}=await V({sn:k.value.sn});e.close(),h.value=a.data,x.value=!0},j=p({get:()=>d.show,set:()=>o("update:show")});return v(d,(()=>{d.show&&(f.value.capacity_item_id=d.mealData.items[0].capacity_item_id,f.value.capacity_id=d.mealData.capacity_id,f.value.price=d.mealData.items[0].price)})),R(((o,d)=>{const r=a("el-menu-item"),p=a("el-menu"),v=a("el-aside"),b=a("el-button"),w=a("el-main"),C=a("el-container"),V=a("el-dialog"),P=a("el-image"),U=a("el-form-item"),T=a("el-form");return l(),t(s,null,[i(V,{title:"空间扩展",modelValue:g(j),"onUpdate:modelValue":d[1]||(d[1]=e=>_(j)?j.value=e:null),width:"719px","custom-class":"confirm-receipt",onClose:S},{default:R((()=>[i("div",X,[(l(!0),t(s,null,m(e.mealData.items,((e,a)=>(l(),t("div",{class:["choice-box",[f.value.capacity_item_id==e.capacity_item_id?"currentStyle":""]],onClick:a=>(e=>{f.value.capacity_item_id=e.capacity_item_id,f.value.price=e.price})(e),key:Number(a)},[i("div",Z,u(e.name),1),i("div",Q,"¥"+u(e.price),1)],10,["onClick"])))),128))]),i(C,null,{default:R((()=>[i(v,{width:"126px"},{default:R((()=>[i(p,{"default-active":f.value.code,disabled:""},{default:R((()=>[(l(!0),t(s,null,m(n.value,(e=>(l(),t(r,{index:e.key,disabled:k.value,onClick:a=>f.value.code=e.key,key:e.key},{default:R((()=>[y(u(e.name),1)])),_:2},1032,["index","disabled","onClick"])))),128))])),_:1},8,["default-active"])])),_:1}),i(w,null,{default:R((()=>[k.value?(l(),t(O,{key:0,code:f.value.code,type:k.value.type,data:k.value.data,price:f.value.price},null,8,["code","type","data","price"])):(l(),t(b,{key:1,type:"primary",onClick:z},{default:R((()=>[Y])),_:1}))])),_:1})])),_:1})])),_:1},8,["modelValue"]),i(V,{title:"空间扩展",modelValue:x.value,"onUpdate:modelValue":d[3]||(d[3]=e=>x.value=e),width:"719px"},{default:R((()=>[i("div",ee,[2==h.value.status?(l(),t("div",ae,[i(P,{src:"/addons/weitshop_shop/weshop/public/home/backend/images/common/success.png"}),le])):c("",!0),-1==h.value.status?(l(),t("div",te,[i(P,{src:"/addons/weitshop_shop/weshop/public/home/backend/images/common/success.png"}),se])):c("",!0),1==h.value.status?(l(),t("div",ie,[i(P,{src:"/addons/weitshop_shop/weshop/public/home/backend/images/common/success.png"}),ue])):c("",!0),i(T,{class:"form-info","label-width":"250px"},{default:R((()=>[i(U,{label:"实付金额"},{default:R((()=>[i("span",ce,"¥"+u(h.value.price),1)])),_:1}),i(U,{label:"订单编号"},{default:R((()=>[y(u(h.value.sn),1)])),_:1}),i(U,{label:"支付方式"},{default:R((()=>[y(u(h.value.pay_name),1)])),_:1}),i(U,{label:"套餐名称"},{default:R((()=>[y(u(h.value.capacity_name),1)])),_:1})])),_:1}),i(b,{type:"primary",onClick:d[2]||(d[2]=e=>j.value=!1)},{default:R((()=>[oe])),_:1})])])),_:1},8,["modelValue"])],64)}))}});de.__scopeId="data-v-7cbee10c";const ne=o();d("data-v-361d26a6");const re={class:"header-container oe-flex oe-row-between"},pe={class:"el-aside-box"},ve=y(" 新增分组"),me={class:"group-title"},ye={key:0,class:"capacity-container"},ge={class:"capacity-text oe-flex oe-row-between"},_e={class:"tips"},fe=y("扩展"),xe={key:1,class:"capacity-container"},he={class:"capacity-text oe-flex oe-row-between"},ke={class:"tips"},be=y("添加图片"),we=i("div",{class:"tips"}," 可拖拽图片至此进行上传，图片大小不超过10M，支持图片格式jpg/png/gif ",-1),Ce=y("添加视频"),Ve=i("div",{class:"tips"}," 可拖拽视频至此进行上传，视频大小不超过50M，支持音频格式mp4 ",-1),ze=y("添加音频"),Se=i("div",{class:"tips"}," 可拖拽音频至此进行上传，音频大小不超过2M，支持音频格式mp3 ",-1),je={class:"material-list"},Pe={class:"image-edit-block"},Ue=y(" 查看 "),Te=i("i",{class:"el-icon-check"},null,-1),Ne=i("i",{class:"el-icon-delete"},null,-1),De=i("span",{class:"text"},"彻底删除",-1),Be={class:"title"},qe={class:"tips"},Ie={class:"control-container oe-flex oe-row-between"},Me={class:"left-column"},Ae=y(" 全选当前页 "),Fe=y(" 删除 "),$e=y(" 移动 "),Ge=y(" 彻底删除 "),Ke={class:"oe-flex"},We={class:"dialog-footer"},Ee=y("取 消"),He=y("确 定"),Je={class:"oe-flex"},Le={class:"dialog-footer"},Oe=y("取 消"),Re=y("确 定"),Xe={class:"view-resources"};n();var Ze=e({expose:[],setup(e){const{pagination:o,handleSizeChange:d,handleCurrentChange:n}=z(),y=r("1"),b=r(),C=r(),V=r([]),{isSelectAll:K,selectIds:W,selectItems:E}=S(V),H=G(),J=r(!1),L=f({groupText:""}),O=f({groupName:""}),R=r(!1),X=r(""),Z=r([]),Q=r(0),Y=r(!1),ee=r([".jpeg,.png,.jpg,.gif",".mp3",".mp4"]),ae=r(0),le=r(0),te=r(0),se=r([]),ie=r(""),ue=r(),ce=f({groupText:[{required:!0,message:"请输入分组内容",trigger:"blur"}],groupName:[{required:!0,message:"请选择需要移动的分组",trigger:"blur"}]}),oe=()=>{o.currentPage=1,la()},Ze=r(!1),Qe=async()=>{C.value.validate((e=>{if(!e)return!1;Ye()}))},Ye=async()=>{const{data:e}=await N({old_group_id:se.value[te.value].id,new_group_id:O.groupName,move_ids:W.value,type:y.value});0==e.code&&(D.success("移动分组成功"),Ze.value=!1,la())},ea=()=>{b.value.validate((e=>{if(!e)return!1;aa()}))},aa=async()=>{const{data:e}=await B({group_name:L.groupText,type:y.value});0==e.code&&(ta(!0),L.groupText="",J.value=!1,oa())},la=async()=>{const{data:e}=await q({group_id:se.value[te.value].id,page:o.currentPage,limit:o.pageSize,searchname:ie.value,type:y.value});0==e.code&&(V.value=e.data.list,o.total=e.data.count,V.value.map((e=>{e.select=!1})))},ta=async e=>{const{data:a}=await I({need_default_list:0,type:y.value});0==a.code&&(se.value=[{id:0,name:"全部"},...a.data.list],e||la())},sa=async(e,a)=>{const l=[];for(let s=0;s<E.value.length;s++)l.push(E.value[s].shop_upload_group_id);await M.confirm("确认删除图片么？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const{data:t}=await F({is_real:a,delete_groups:0==se.value[te.value].id?l:[se.value[te.value].id],delete_ids:e,type:y.value});0==t.code&&(la(),oa())},ia=()=>{ue.value.close()},ua=e=>{0==e.code&&(ue.value.close(),la(),oa())},ca=j.headers.common,oa=async()=>{const{data:e}=await $({shop_id:j.headers.common.shopid});Q.value=e.data.capacity_switch,ae.value=Number((e.data.used_container_size/1024/1024).toFixed(2)),le.value=Number((e.data.container_size/1024/1024/1024).toFixed(2))},da=p((()=>se.value[te.value]?`${j.baseURL}shop/upload/add/${se.value[te.value].id}`:"")),na=e=>{let a=0;a="1"==y.value?10:"2"==y.value?2:50;const l=e.size/1024/1024<a;return l?ue.value=w.service({background:"rgba(0,0,0,0.1)",text:"上传中...",spinner:"el-icon-loading"}):D.error(`上传文件大小不能超过!${a}MB`),l},ra=p((()=>({type:y.value})));return v(y,(()=>{te.value=0,o.currentPage=1,ta()})),v([()=>o.currentPage,()=>o.pageSize],(()=>la())),x((()=>{ta(),oa(),"w7"!=P.state.common.env&&(async()=>{const{data:e}=await T();Z.value=e.data})()})),ne(((e,r)=>{const p=a("el-tab-pane"),v=a("el-tabs"),f=a("el-input"),x=a("el-button"),w=a("el-menu-item"),z=a("el-menu"),S=a("el-aside"),j=a("el-link"),P=a("el-progress"),T=a("el-upload"),N=a("el-image"),D=a("el-col"),B=a("el-row"),q=a("el-empty"),I=a("el-checkbox"),F=a("el-pagination"),$=a("el-main"),G=a("el-container"),E=a("el-card"),ue=a("el-form-item"),Ye=a("el-form"),aa=a("el-dialog"),pa=a("el-option"),va=a("el-select");return l(),t(s,null,[i(E,{shadow:"never",class:"custom-crad-container"},{default:ne((()=>[i("div",re,[i(v,{class:"custom-tabs",modelValue:y.value,"onUpdate:modelValue":r[1]||(r[1]=e=>y.value=e)},{default:ne((()=>[i(p,{label:"图片",name:"1"}),i(p,{label:"视频",name:"3"}),i(p,{label:"音频",name:"2"})])),_:1},8,["modelValue"]),i(f,{onKeyup:h(oe,["enter"]),placeholder:"请输入图标名称",modelValue:ie.value,"onUpdate:modelValue":r[2]||(r[2]=e=>ie.value=e),class:"search-inp"},{suffix:ne((()=>[i("i",{class:"el-input__icon el-icon-search",style:{cursor:"pointer"},onClick:oe})])),_:1},8,["onKeyup","modelValue"])]),i(G,{class:"body-container"},{default:ne((()=>[i("div",pe,[i(S,null,{default:ne((()=>[i(x,{type:"primary",icon:"el-icon-plus",onClick:r[3]||(r[3]=e=>J.value=!0)},{default:ne((()=>[ve])),_:1}),i(z,{"default-active":te.value.toString()},{default:ne((()=>[(l(!0),t(s,null,m(se.value,((e,a)=>(l(),t(w,{onClick:e=>(e=>{te.value=e,o.currentPage=1,la()})(a),index:a,key:a},{title:ne((()=>[i("div",me,u(e.name),1)])),default:ne((()=>[0!=a&&"未分组"!=e.name?(l(),t("i",{key:0,class:"ad-recovery delete-img",onClick:e=>(async e=>{await M.confirm("确认删除该分组么？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await A({group_ids:[se.value[e].id]}),te.value=0,ta(),oa()})(a)},null,8,["onClick"])):c("",!0)])),_:2},1032,["onClick","index"])))),128))])),_:1},8,["default-active"])])),_:1}),0!=Q.value?(l(),t("div",ye,[i("div",ge,[i("span",_e,u(ae.value)+"M/"+u(le.value)+"G",1),i(j,{type:"primary",onClick:r[4]||(r[4]=e=>Y.value=!0),href:"javascript:;"},{default:ne((()=>[fe])),_:1})]),i(P,{percentage:ae.value/le.value/1024*100,"show-text":!1},null,8,["percentage"])])):c("",!0),0==Q.value?(l(),t("div",xe,[i("div",he,[i("span",ke,"已使用"+u(ae.value)+"M",1)])])):c("",!0)]),i($,null,{default:ne((()=>[i(T,{class:"custom-upload",action:g(da),"on-error":ia,"show-file-list":!1,headers:g(ca),"on-success":ua,data:g(ra),drag:!0,multiple:"","before-upload":na,accept:ee.value[Number(y.value)-1]},{default:ne((()=>["1"==y.value?(l(),t(s,{key:0},[i(x,{type:"primary",icon:"el-icon-plus"},{default:ne((()=>[be])),_:1}),we],64)):c("",!0),"3"==y.value?(l(),t(s,{key:1},[i(x,{type:"primary",icon:"el-icon-plus"},{default:ne((()=>[Ce])),_:1}),Ve],64)):c("",!0),"2"==y.value?(l(),t(s,{key:2},[i(x,{type:"primary",icon:"el-icon-plus"},{default:ne((()=>[ze])),_:1}),Se],64)):c("",!0)])),_:1},8,["action","headers","data","accept"]),i("div",je,[i(B,null,{default:ne((()=>[(l(!0),t(s,null,m(V.value,((e,a)=>(l(),t(D,{class:"image-edit-item",xs:4,sm:4,xl:3,key:a,onClick:a=>e.select=!e.select},{default:ne((()=>[i("div",Pe,[i("div",{class:["image-mark oe-flex oe-row-center",{on:e.select}]},[i(x,{size:"xl"==g(H)?"":"mini",type:"primary",onClick:k((a=>{return l=e.path.url,X.value=l,void(R.value=!0);var l}),["stop"])},{default:ne((()=>[Ue])),_:2},1032,["size","onClick"]),Te,e.select?(l(),t("div",{key:0,class:"foot-btns",onClick:r[5]||(r[5]=e=>sa(g(W),1))},[Ne,De])):c("",!0)],2),"1"==y.value?(l(),t(N,{key:0,fit:"cover",src:e.path.url},null,8,["src"])):c("",!0),"3"==y.value?(l(),t("video",{key:1,src:e.path.url,controls:"controls"},null,8,["src"])):c("",!0),"2"==y.value?(l(),t("audio",{key:2,src:e.path.url},null,8,["src"])):c("",!0)]),i("div",Be,u(e.name),1),i("div",qe,u(g(U)(e.updatetime)),1)])),_:2},1032,["onClick"])))),128))])),_:1}),V.value.length?c("",!0):(l(),t(q,{key:0,class:"oe-m-t-30",description:"暂无数据"})),i("div",Ie,[i("div",Me,[i(I,{modelValue:g(K),"onUpdate:modelValue":r[6]||(r[6]=e=>_(K)?K.value=e:null)},{default:ne((()=>[Ae])),_:1},8,["modelValue"]),i(j,{type:"primary",href:"javascript:;",onClick:r[7]||(r[7]=e=>sa(g(W),0)),disabled:!g(W).length},{default:ne((()=>[Fe])),_:1},8,["disabled"]),i(j,{type:"primary",href:"javascript:;",disabled:!g(W).length,onClick:r[8]||(r[8]=e=>Ze.value=!0)},{default:ne((()=>[$e])),_:1},8,["disabled"]),i(j,{type:"primary",href:"javascript:;",disabled:!g(W).length,onClick:r[9]||(r[9]=e=>sa(g(W),1))},{default:ne((()=>[Ge])),_:1},8,["disabled"])]),i(F,{class:"right-column",onSizeChange:g(d),onCurrentChange:g(n),"page-sizes":g(o).pageSizes,"page-size":g(o).pageSize,background:"",layout:"total, prev, pager, next,sizes, jumper",total:g(o).total,"current-page":g(o).currentPage},null,8,["onSizeChange","onCurrentChange","page-sizes","page-size","total","current-page"])])])])),_:1})])),_:1})])),_:1}),i(aa,{title:"新增分组",modelValue:J.value,"onUpdate:modelValue":r[12]||(r[12]=e=>J.value=e),width:"500px"},{footer:ne((()=>[i("span",We,[i(x,{onClick:r[11]||(r[11]=e=>J.value=!1)},{default:ne((()=>[Ee])),_:1}),i(x,{type:"primary",onClick:ea},{default:ne((()=>[He])),_:1})])])),default:ne((()=>[i("div",Ke,[i(Ye,{model:g(L),ref:b,"label-width":"80px",rules:g(ce)},{default:ne((()=>[i(ue,{label:"分组名称",prop:"groupText"},{default:ne((()=>[i(f,{modelValue:g(L).groupText,"onUpdate:modelValue":r[10]||(r[10]=e=>g(L).groupText=e),style:{width:"300px"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["modelValue"]),i(aa,{title:"移动",modelValue:Ze.value,"onUpdate:modelValue":r[15]||(r[15]=e=>Ze.value=e),width:"500px"},{footer:ne((()=>[i("span",Le,[i(x,{onClick:r[14]||(r[14]=e=>Ze.value=!1)},{default:ne((()=>[Oe])),_:1}),i(x,{type:"primary",onClick:Qe},{default:ne((()=>[Re])),_:1})])])),default:ne((()=>[i("div",Je,[i(Ye,{model:g(O),ref:C,"label-width":"80px",rules:g(ce)},{default:ne((()=>[i(ue,{label:"选择分组",prop:"groupName"},{default:ne((()=>[i(va,{modelValue:g(O).groupName,"onUpdate:modelValue":r[13]||(r[13]=e=>g(O).groupName=e),clearable:"",placeholder:"请选择"},{default:ne((()=>[(l(!0),t(s,null,m(se.value,(e=>(l(),t(pa,{key:e.name,label:e.name,value:e.id,disabled:e.id==se.value[te.value].id},null,8,["label","value","disabled"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["modelValue"]),i(de,{show:Y.value,"onUpdate:show":r[16]||(r[16]=e=>Y.value=e),mealData:Z.value},null,8,["show","mealData"]),i("div",Xe,[i(aa,{modelValue:R.value,"onUpdate:modelValue":r[17]||(r[17]=e=>R.value=e),title:"查看",width:"580px"},{default:ne((()=>["1"==y.value?(l(),t(N,{key:0,fit:"cover",src:X.value},null,8,["src"])):c("",!0),"3"==y.value?(l(),t("video",{key:1,controls:"controls",src:X.value},null,8,["src"])):c("",!0),"2"==y.value?(l(),t("audio",{key:2,src:X.value,controls:"controls"},null,8,["src"])):c("",!0)])),_:1},8,["modelValue"])])],64)}))}});Ze.__scopeId="data-v-361d26a6";export default Ze;
