import{c as e,a,u as l}from"./index.a53c91c6.js";import{n as t,d as s,o as r}from"./member.c7d788b5.js";import{a as d,e as o,l as i,b as u,o as n,c,g as p,F as m,P as v,u as g,f,k as _,p as b,X as h,h as y,w,m as k,t as C,s as x}from"./vendor.71e19cde.js";const z=_();b("data-v-62326423");const I={class:"member-modality"},V={class:"card-header"},S=p("i",{class:"el-icon-warning"},null,-1),G={class:"header-tips"},L=p("div",null,"删除会员等级",-1),j=p("div",null,"请先对自定义会等级下会员转入其他会员等级下",-1),F=p("div",null,"如不转移，等级下会员则自动转入普通等级下",-1),q={class:"footer-right"},M=h("取消"),P=h("确定");y();var U=d({expose:[],props:{show:{type:Boolean,required:!0},currentItem:{type:Object,required:!0},gradeList:{type:Array,required:!0}},setup(a,{emit:l}){const s=a,r=o({get:()=>s.show,set:()=>l("update:show")}),d=i({transferId:""}),_=async()=>{const a={old_id:s.currentItem.id,is_delete_old:1};""!=d.value.transferId&&(a.new_id=d.value.transferId),await t(a),l("resetGradeList"),e.success("操作成功!!"),r.value=!1};return z(((e,l)=>{const t=u("el-option"),s=u("el-select"),o=u("el-form-item"),i=u("el-form"),b=u("el-button"),h=u("el-dialog");return n(),c("div",I,[p(h,{modelValue:g(r),"onUpdate:modelValue":l[3]||(l[3]=e=>f(r)?r.value=e:null),width:"472px"},{title:z((()=>[p("div",V,[S,p("div",G,[L,j,F,p(i,{model:d.value,"label-width":"70px",class:"delete-form"},{default:z((()=>[p(o,{label:"会员转移"},{default:z((()=>[p(s,{modelValue:d.value.transferId,"onUpdate:modelValue":l[1]||(l[1]=e=>d.value.transferId=e),placeholder:"选择会员等级",clearable:""},{default:z((()=>[(n(!0),c(m,null,v(a.gradeList,(e=>(n(),c(t,{disabled:e.level_name==a.currentItem.level_name,key:e.level_name,label:e.level_name,value:e.id},null,8,["disabled","label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])])])),footer:z((()=>[p("div",q,[p(b,{size:"mini",onClick:l[2]||(l[2]=e=>r.value=!1)},{default:z((()=>[M])),_:1}),p(b,{size:"mini",type:"primary",onClick:_},{default:z((()=>[P])),_:1})])])),_:1},8,["modelValue"])])}))}});U.__scopeId="data-v-62326423";const B=_();b("data-v-65e282ad");const A=h("新增等级"),D=p("div",{class:"tips-box"}," 当自定义会员等级的会员数大于0时，如需删除应先将该会员等级下对应会员转移到其他会员等级下，如不转移，则自动转移到系统默认会员等级下。 ",-1),E={class:"summary-text"},O={key:0},R={key:1},X={key:0,style:{color:"#ff0000"}},H={key:1,style:{color:"#1ad370"}},J={key:2,style:{color:"#1ad370"}},K={class:"oe-flex oe-flex-wrap"},N=h("系统默认等级"),Q=h("编辑"),T=h("禁用 "),W=h("启动 "),Y=h("删除 "),Z={class:"delete-box"},$=p("div",{class:"oe-flex"},[p("i",{class:"el-icon-warning"}),p("div",{class:"card-header"},[p("div",{class:"card-header-title"},"删除会员等级"),p("div",{class:"card-header-text"},"您确定要删除该会员等级么？")])],-1),ee={class:"footer-right"},ae=h("取消"),le=h("确定");y();var te=d({expose:[],setup(d){const{pagination:o,handleSizeChange:v,handleCurrentChange:f}=a(),_=i([]),b=l(),h=i(""),y=i(""),z=i({delMemberGrade:!1}),I=i(!1),V=i({}),S=async()=>{const{data:e}=await s({page:o.currentPage,limit:o.pageSize,sort:h.value,order:y.value});_.value=e.data.data,o.total=e.data.total},G=e=>{y.value=e.prop,"descending"==e.order?(h.value="desc",S()):(h.value="asc",S())},L=async()=>{await t({old_id:V.value.id,is_delete_old:1}),e.success("操作成功"),I.value=!1,S()},j=async(e,a)=>{await r({ids:[e.id],params:{status:a}}),S()};return w([()=>o.currentPage,()=>o.pageSize],(()=>{S()})),k((()=>S())),B(((e,a)=>{const l=u("el-button"),t=u("el-empty"),s=u("el-table-column"),r=u("custom-button"),d=u("el-table"),i=u("el-pagination"),h=u("el-col"),y=u("el-card"),w=u("el-dialog");return n(),c(m,null,[p(y,{shadow:"never",class:"grade-box custom-card-page"},{default:B((()=>[p(l,{type:"primary",class:"newly-added",icon:"el-icon-plus",onClick:a[1]||(a[1]=e=>g(b).push("/member/member-create-grade"))},{default:B((()=>[A])),_:1}),D,p(d,{class:"grade-list",data:_.value,style:{width:"100%"},onSortChange:G},{empty:B((()=>[p(t,{class:"oe-m-t-30",description:"暂无会员等级"})])),default:B((()=>[p(s,{prop:"name",label:"等级"}),p(s,{prop:"level_name",label:"名称"}),p(s,{prop:"remark",label:"概述"},{default:B((e=>[p("div",E,C(e.row.remark),1)])),_:1}),p(s,{prop:"address",label:"权益"},{default:B((e=>[0==e.row.discount?(n(),c("div",O,"无")):(n(),c("div",R,C(e.row.discount/10)+"折",1))])),_:1}),p(s,{prop:"shop_user_num",label:"会员数",sortable:""}),p(s,{prop:"address",label:"状态"},{default:B((e=>[0==e.row.status&&1!=e.row.is_default?(n(),c("div",X," 禁用中 ")):x("",!0),1==e.row.status&&1!=e.row.is_default?(n(),c("div",H," 启用中 ")):x("",!0),1==e.row.is_default?(n(),c("div",J,"启用中")):x("",!0)])),_:1}),p(s,{prop:"address",label:"操作","min-width":"150"},{default:B((e=>[p("div",K,[1==e.row.is_default?(n(),c(l,{key:0,type:"primary",class:"public-move-right"},{default:B((()=>[N])),_:1})):x("",!0),1!=e.row.is_default?(n(),c(m,{key:1},[p(l,{onClick:a=>{return l=e.row,void b.push({path:"/member/member-create-grade",query:{id:l.id}});var l},type:"primary",icon:"ad-edit",class:"public-move-right"},{default:B((()=>[Q])),_:2},1032,["onClick"]),1==e.row.status?(n(),c(r,{key:0,icon:"ad-close",color:"#FE6712",class:"public-move-right",onClick:a=>j(e.row,0)},{default:B((()=>[T])),_:2},1032,["onClick"])):x("",!0),0==e.row.status?(n(),c(r,{key:1,icon:"ad-start-up",class:"public-move-right",color:"#2DB6F5",onClick:a=>j(e.row,1)},{default:B((()=>[W])),_:2},1032,["onClick"])):x("",!0),p(r,{icon:"ad-delete",color:"#FF0000",onClick:a=>{return 0==(l=e.row).shop_user_num?I.value=!0:z.value.delMemberGrade=!0,void(V.value=l);var l}},{default:B((()=>[Y])),_:2},1032,["onClick"])],64)):x("",!0)])])),_:1})])),_:1},8,["data"]),p(h,{lg:24,class:"paging-box"},{default:B((()=>[p(i,{class:"e-grid","page-sizes":g(o).pageSizes,onSizeChange:g(v),onCurrentChange:g(f),"page-size":g(o).pageSize,background:"","current-page":g(o).currentPage,layout:"total, prev, pager, next,sizes, jumper",total:g(o).total},null,8,["page-sizes","onSizeChange","onCurrentChange","page-size","current-page","total"])])),_:1})])),_:1}),p(U,{gradeList:_.value,show:z.value.delMemberGrade,"onUpdate:show":a[2]||(a[2]=e=>z.value.delMemberGrade=e),onResetGradeList:S,currentItem:V.value},null,8,["gradeList","show","currentItem"]),p("div",Z,[p(w,{modelValue:I.value,"onUpdate:modelValue":a[4]||(a[4]=e=>I.value=e),width:"550px"},{title:B((()=>[$])),footer:B((()=>[p("div",ee,[p(l,{size:"mini",onClick:a[3]||(a[3]=e=>I.value=!1)},{default:B((()=>[ae])),_:1}),p(l,{size:"mini",type:"primary",onClick:L},{default:B((()=>[le])),_:1})])])),_:1},8,["modelValue"])])],64)}))}});te.__scopeId="data-v-65e282ad";export default te;
