var e=Object.defineProperty,a=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,t=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,p=(e,p)=>{for(var u in p||(p={}))a.call(p,u)&&r(e,u,p[u]);if(l)for(var u of l(p))t.call(p,u)&&r(e,u,p[u]);return e};import{u,A as i,c,b0 as o}from"./index.a53c91c6.js";import{a as d,l as s,e as n,b as y,o as m,c as b,g as _,F as v,u as f,s as g,k as h,p as P,X as U,h as C}from"./vendor.71e19cde.js";const I=h();P("data-v-548f8369");const k=U("微信支付"),V=U("支付宝支付"),q=_("div",{class:"tips-text"},"支付方式保存后不可修改，请谨慎操作",-1),K=U("上传文件"),x=_("div",{class:"el-upload__tip"},[U("商户可登录 "),_("a",{href:"https://pay.weixin.qq.com/",target:"_blank"},"微信商户平台 "),U("，在【账户中心】->【API安全】->【API证书】目录下载证书 "),_("br"),U("上传证书中的apiclient_cert.pem文件")],-1),A=U("上传文件"),R=_("div",{class:"el-upload__tip"},[U("商户可登录 "),_("a",{href:"https://pay.weixin.qq.com/",target:"_blank"},"微信商户平台 "),U(" ，在【账户中心】->【API安全】->【API证书】目录下载证书 "),_("br"),U("上传证书中的apiclient_key.pem文件")],-1),w=U("上传文件"),D=_("div",{class:"el-upload__tip"},[U(" 商户可登录 "),_("a",{href:"https://b.alipay.com/",target:"_blank"},"支付宝开发平台"),U("，在【控制台】>【选择应用】>【应用信息】>【接口加签方式】>【设置/查看】中下载证书后"),_("br"),U(" 上传证书中的 alipayCertPublicKey.crt 文件，如名称不同，请先修改成alipayCertPublicKey.crt后再进行上传 ")],-1),M=U("上传文件"),j=_("div",{class:"el-upload__tip"},[U(" 商户可登录 "),_("a",{href:"https://b.alipay.com/",target:"_blank"},"支付宝开发平台"),U(" ，在【控制台】>【选择应用】>【应用信息】>【接口加签方式】>【设置/查看】中下载证书后"),_("br"),U(" 上传证书中的 alipayRootCert.crt 文件，如名称不同，请先修改成alipayRootCert.crt后再进行上传 ")],-1),O=U("上传文件"),W=_("div",{class:"el-upload__tip"},[U(" 商户可登录 "),_("a",{href:"https://b.alipay.com/",target:"_blank"},"支付宝开发平台"),U(" ，在【控制台】>【选择应用】>【应用信息】>【接口加签方式】>【设置/查看】中下载证书后"),_("br"),U(" 上传证书中的 appCertPublicKey.crt 文件，如名称不同，请先修改成appCertPublicKey.crt后再进行上传 ")],-1),S={class:"oe-flex operation"},E=U("取消"),F=U("保存");C();var L=d({expose:[],setup(e){const a=u(),l=s(),t=s(""),r=s({dispatch_name:"",calculate_type:"WxPay",aapId:"",paymentMerchant:"",paymentPublic:"",applicationId:"",applicationPublic:"",alipayPublic:"",certUrl:"",keyUrl:"",alipayCertUrl:"",alipayRootUrl:"",alipayPublicUrl:""}),d=s({dispatch_name:[{required:!0,message:"请填写模板名称",trigger:"blur"}],calculate_type:[{required:!0,message:"请选择支付类型",trigger:"blur"}],aapId:[{required:!0,message:"请填写AppID",trigger:"blur"}],paymentMerchant:[{required:!0,message:"请填写支付商户号",trigger:"blur"}],paymentPublic:[{required:!0,message:"请填写支付密钥",trigger:"blur"}],applicationId:[{required:!0,message:"请填写应用ID",trigger:"blur"}],applicationPublic:[{required:!0,message:"请填写应用公钥",trigger:"blur"}],alipayPublic:[{required:!0,message:"请填写支付宝公钥",trigger:"blur"}],certUrl:[{required:!0,message:"请上传商户Cert证书",trigger:"blur"}],keyUrl:[{required:!0,message:"请上传商户Key证书",trigger:"blur"}],alipayCertUrl:[{required:!0,message:"请上传alipayCertPublicKey.crt证书",trigger:"blur"}],alipayRootUrl:[{required:!0,message:"请上传alipayRootCert.crt证书",trigger:"blur"}],alipayPublicUrl:[{required:!0,message:"请上传appCertPublicKey.crt证书",trigger:"blur"}]}),h=()=>{r.value.certUrl=""},P=()=>{r.value.keyUrl=""},U=()=>{r.value.alipayCertUrl=""},C=()=>{r.value.alipayRootUrl=""},L=()=>{r.value.alipayPublicUrl=""},X=(e,a,l)=>{0==e.code?r.value.certUrl=e.data.url:c.error("文件上传失败")},$=(e,a,l)=>{0==e.code&&(r.value.keyUrl=e.data.url)},z=(e,a,l)=>{0==e.code&&(r.value.alipayCertUrl=e.data.url)},B=(e,a,l)=>{0==e.code&&(r.value.alipayRootUrl=e.data.url)},G=(e,a,l)=>{0==e.code&&(r.value.alipayPublicUrl=e.data.url)},H=e=>{if("apiclient_cert.pem"!=e.name)return c.error("请上传对应的文件"),!1},J=e=>{if("apiclient_key.pem"!=e.name)return c.error("请上传对应的文件"),!1},N=e=>{if("alipayCertPublicKey.crt"!=e.name)return c.error("请上传对应的文件"),!1},Q=e=>{if("alipayRootCert.crt"!=e.name)return c.error("请上传对应的文件"),!1},T=e=>{if("appCertPublicKey.crt"!=e.name)return c.error("请上传对应的文件"),!1},Y=i.headers.common,Z=()=>{t.value.validate((e=>{e&&ae()}))},ee=n((()=>`${i.baseURL}shop/PayShopConfig/upload`)),ae=async()=>{const e={name:r.value.dispatch_name,pay_code:r.value.calculate_type,app_id:r.value.aapId,mch_id:r.value.paymentMerchant,key:r.value.paymentPublic,apiclient_cert:r.value.certUrl,apiclient_key:r.value.keyUrl},l={name:r.value.dispatch_name,pay_code:r.value.calculate_type,app_id:r.value.applicationId,key:r.value.alipayPublic,alipayCertPublicKey:r.value.alipayCertUrl,alipayRootCert:r.value.alipayRootUrl,appCertPublicKey:r.value.alipayPublicUrl};"WxPay"==r.value.calculate_type?await o(p({},e)):await o(p({},l)),c.success("操作成功"),a.go(-1)};return I(((e,p)=>{const u=y("el-input"),i=y("el-form-item"),c=y("el-radio"),o=y("el-radio-group"),s=y("el-button"),n=y("el-upload"),ae=y("el-card"),le=y("el-form");return m(),b(le,{model:r.value,ref:t,rules:d.value,"label-width":"210px",class:"notice-box"},{default:I((()=>[_(ae,{shadow:"never"},{default:I((()=>[_(i,{label:"模板名称",prop:"dispatch_name"},{default:I((()=>[_(u,{class:"sort-inp",modelValue:r.value.dispatch_name,"onUpdate:modelValue":p[1]||(p[1]=e=>r.value.dispatch_name=e),placeholder:"输入支付模板名称"},null,8,["modelValue"])])),_:1}),_(i,{label:"支付类型",prop:"calculate_type"},{default:I((()=>[_(o,{modelValue:r.value.calculate_type,"onUpdate:modelValue":p[2]||(p[2]=e=>r.value.calculate_type=e)},{default:I((()=>[_(c,{label:"WxPay"},{default:I((()=>[k])),_:1}),_(c,{label:"AliPay"},{default:I((()=>[V])),_:1})])),_:1},8,["modelValue"]),q])),_:1}),"WxPay"==r.value.calculate_type?(m(),b(v,{key:0},[_(i,{label:"App ID",prop:"aapId"},{default:I((()=>[_(u,{class:"sort-inp",modelValue:r.value.aapId,"onUpdate:modelValue":p[3]||(p[3]=e=>r.value.aapId=e),placeholder:"输入公众号/小程序的App ID"},null,8,["modelValue"])])),_:1}),_(i,{label:"支付商户号",prop:"paymentMerchant"},{default:I((()=>[_(u,{class:"sort-inp",modelValue:r.value.paymentMerchant,"onUpdate:modelValue":p[4]||(p[4]=e=>r.value.paymentMerchant=e),placeholder:"输入支付商户号（Mch_ID）"},null,8,["modelValue"])])),_:1}),_(i,{label:"支付密钥",prop:"paymentPublic"},{default:I((()=>[_(u,{class:"sort-inp",modelValue:r.value.paymentPublic,"onUpdate:modelValue":p[5]||(p[5]=e=>r.value.paymentPublic=e),placeholder:"输入支付密钥（Apikey）"},null,8,["modelValue"])])),_:1}),_(i,{label:"商户Cert证书",prop:"certUrl"},{default:I((()=>[_(n,{class:"upload-demo",headers:f(Y),ref:l,accept:".pem","on-success":X,data:{pay_code:r.value.calculate_type},action:f(ee),"before-upload":H,limit:1,"on-remove":h},{tip:I((()=>[x])),default:I((()=>[_(s,{plain:""},{default:I((()=>[K])),_:1})])),_:1},8,["headers","data","action"])])),_:1}),_(i,{label:"商户Key证书",prop:"keyUrl"},{default:I((()=>[_(n,{headers:f(Y),data:{pay_code:r.value.calculate_type},action:f(ee),"on-success":$,class:"upload-demo",accept:".pem","before-upload":J,"on-remove":P,limit:1},{tip:I((()=>[R])),default:I((()=>[_(s,{plain:""},{default:I((()=>[A])),_:1})])),_:1},8,["headers","data","action"])])),_:1})],64)):g("",!0),"AliPay"==r.value.calculate_type?(m(),b(v,{key:1},[_(i,{label:"App ID",prop:"applicationId"},{default:I((()=>[_(u,{class:"sort-inp",modelValue:r.value.applicationId,"onUpdate:modelValue":p[6]||(p[6]=e=>r.value.applicationId=e),placeholder:"输入App ID"},null,8,["modelValue"])])),_:1}),_(i,{label:"支付宝密钥",prop:"alipayPublic"},{default:I((()=>[_(u,{class:"sort-inp",modelValue:r.value.alipayPublic,"onUpdate:modelValue":p[7]||(p[7]=e=>r.value.alipayPublic=e),placeholder:"输入支付宝密钥"},null,8,["modelValue"])])),_:1}),_(i,{label:"alipayCertPublicKey.crt证书",prop:"alipayCertUrl"},{default:I((()=>[_(n,{class:"upload-demo",accept:".crt","on-success":z,"before-upload":N,limit:1,headers:f(Y),"on-remove":U,data:{pay_code:r.value.calculate_type},action:f(ee)},{tip:I((()=>[D])),default:I((()=>[_(s,{plain:""},{default:I((()=>[w])),_:1})])),_:1},8,["headers","data","action"])])),_:1}),_(i,{label:"alipayRootCert.crt证书",prop:"alipayRootUrl"},{default:I((()=>[_(n,{class:"upload-demo",accept:".crt",headers:f(Y),"on-success":B,"before-upload":Q,data:{pay_code:r.value.calculate_type},action:f(ee),limit:1,"on-remove":C},{tip:I((()=>[j])),default:I((()=>[_(s,{plain:""},{default:I((()=>[M])),_:1})])),_:1},8,["headers","data","action"])])),_:1}),_(i,{label:"appCertPublicKey.crt证书",prop:"alipayPublicUrl"},{default:I((()=>[_(n,{class:"upload-demo",accept:".crt",headers:f(Y),"before-upload":T,"on-success":G,data:{pay_code:r.value.calculate_type},action:f(ee),limit:1,"on-remove":L},{tip:I((()=>[W])),default:I((()=>[_(s,{plain:""},{default:I((()=>[O])),_:1})])),_:1},8,["headers","data","action"])])),_:1})],64)):g("",!0),_(i,null,{default:I((()=>[_("div",S,[_(s,{plain:"",onClick:p[8]||(p[8]=e=>f(a).go(-1))},{default:I((()=>[E])),_:1}),_(s,{type:"primary",onClick:Z},{default:I((()=>[F])),_:1})])])),_:1})])),_:1})])),_:1},8,["model","rules"])}))}});L.__scopeId="data-v-548f8369";export default L;
