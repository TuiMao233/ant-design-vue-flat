import{a as e,c as a}from"./index.a53c91c6.js";import{r as l,a as t,b as o}from"./finance.2ba7f690.js";import{_ as s}from"./statistical-export.2f509173.js";import{a as n,l as r,w as u,m as c,b as d,o as i,c as p,g as v,F as g,P as m,t as b,u as f,k as h,p as _,X as y,h as w}from"./vendor.71e19cde.js";const x=h();_("data-v-6e2c29a8");const C=y(" 所有会员的积分变动都会有记录，每日的统计报表会在“次日凌晨”进行更新，每月的统计报表会在“次月首日凌晨”进行更新 "),z=y("导出报表"),k={class:"oe-flex"},S={class:"income-text"},j={class:"expenditure-text"},V=y("查看 ");w();var P=n({expose:[],setup(n){const{pagination:h,handleSizeChange:_,handleCurrentChange:y}=e(),w=r(),P=r([]),U=r(),I=r([]),E=r([]);r(!1);const F=r(!1),L=r(""),R=r(""),A=e=>{O(e),q()},B=()=>{q()},O=async e=>{if(""!=e){const{data:a}=await l({date:e});P.value=a.data}else P.value=[],w.value=""},X=async()=>{const{data:e}=await t({page:h.currentPage,limit:h.pageSize,search:{year:U.value,month:w.value},type:"score"});if(E.value.length){const a=new Blob([e]),l=window.URL.createObjectURL(a),t=document.createElement("a");t.style.display="none",t.href=l,t.setAttribute("download","积分统计报表.xlsx"),document.body.appendChild(t),t.click()}else a("暂无导出的数据！")},q=async()=>{const{data:e}=await o({search:{year:U.value,month:w.value},limit:h.pageSize,page:h.currentPage,type:"score",order:"",sort:""});h.total=e.data.total,E.value=e.data.data,L.value=e.data.date};return u([()=>h.currentPage,()=>h.pageSize],(()=>{q()})),c((()=>{(async()=>{const{data:e}=await l({date:""});I.value=e.data})(),q()})),x(((e,a)=>{const l=d("el-col"),t=d("el-row"),o=d("el-button"),n=d("el-option"),r=d("el-select"),u=d("el-empty"),c=d("el-table-column"),O=d("custom-button"),q=d("el-table"),D=d("el-pagination"),G=d("el-card");return i(),p(g,null,[v(G,{shadow:"never",class:"statistical-box custom-card-page custom-crad-container"},{default:x((()=>[v(t,{class:"tips-box"},{default:x((()=>[v(l,{xl:24},{default:x((()=>[C])),_:1})])),_:1}),v(t,null,{default:x((()=>[v(l,{xl:24,class:"oe-flex oe-row-between"},{default:x((()=>[v("div",null,[v(o,{type:"primary",size:"small",onClick:X},{default:x((()=>[z])),_:1})]),v("div",k,[v(r,{modelValue:U.value,"onUpdate:modelValue":a[1]||(a[1]=e=>U.value=e),placeholder:"全部",clearable:"",onChange:A},{default:x((()=>[(i(!0),p(g,null,m(I.value,(e=>(i(),p(n,{key:e,label:e.name,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),v(r,{modelValue:w.value,"onUpdate:modelValue":a[2]||(a[2]=e=>w.value=e),placeholder:"全部",clearable:"",onChange:B},{default:x((()=>[(i(!0),p(g,null,m(P.value,(e=>(i(),p(n,{key:e,label:e.name,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])),_:1})])),_:1}),v(q,{class:"statistical-list",data:E.value,style:{width:"100%"}},{empty:x((()=>[v(u,{class:"oe-m-t-30",description:"暂无积分统计报表"})])),default:x((()=>[v(c,{prop:"belong_date",label:"日期"}),v(c,{prop:"sum_total_score",label:"本期初始积分",sortable:""}),v(c,{prop:"income",label:"收入",sortable:""},{default:x((e=>[v("div",S,"+"+b(e.row.income),1)])),_:1}),v(c,{prop:"outgo",label:"支出",sortable:""},{default:x((e=>[v("div",j,b(0==e.row.outgo?"":"-")+b(e.row.outgo),1)])),_:1}),v(c,{prop:"sum_score",label:"本期剩余积分",sortable:""}),v(c,{prop:"address",label:"操作"},{default:x((e=>[v(O,{icon:"ad-see",color:"#FE6712",onClick:a=>{return l=e.row.id,F.value=!0,void(R.value=l);var l}},{default:x((()=>[V])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),v(l,{lg:24,class:"paging-box"},{default:x((()=>[v(D,{class:"e-grid","page-sizes":f(h).pageSizes,"page-size":f(h).pageSize,background:"","current-page":f(h).currentPage,layout:"total, prev, pager, next,sizes, jumper",total:f(h).total,onSizeChange:f(_),onCurrentChange:f(y)},null,8,["page-sizes","page-size","current-page","total","onSizeChange","onCurrentChange"])])),_:1})])),_:1}),v(s,{show:F.value,"onUpdate:show":a[3]||(a[3]=e=>F.value=e),currentId:R.value,date_type:L.value,type:"score"},null,8,["show","currentId","date_type"])],64)}))}});P.__scopeId="data-v-6e2c29a8";export default P;
