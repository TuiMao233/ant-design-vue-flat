import{a as e,l,w as a,m as t,b as s,o as u,c as o,g as n,F as i,P as r,Z as d,t as c,s as v,X as m,u as p,k as g,p as b,h as f,d as _}from"./vendor.71e19cde.js";import{u as h,a as x,j as w}from"./index.a53c91c6.js";import{_ as k,a as y,b as V}from"./member-label.a86c3646.js";import{_ as C}from"./section-input.b55c5f18.js";import{r as T,d as S,e as U,f as j,g as z,h as L}from"./member.c7d788b5.js";const I=g();b("data-v-5bbcabd0");const M={class:"oe-flex"},F={class:"oe-flex"},P={class:"oe-flex"},B={class:"oe-flex"},W={class:"oe-flex"},K={class:"oe-flex"},q={class:"oe-flex"},D={class:"oe-flex"},N={class:"oe-flex e-grid screen-btn"},R=m("搜索"),A={class:"oe-flex Member-name"},E={class:"Member-name-text"},G={class:"oe-flex"},J={key:0,class:"blacklist-text"},O={class:"oe-flex oe-flex-wrap label-box"},X=m(" 订单： "),Z={class:"is-color"},H=m(" 累计成交额： "),Q={class:"is-color"},Y=m(" 积分： "),$={class:"is-color"},ee=m(" 余额： "),le={class:"is-color"},ae={class:"oe-flex oe-flex-wrap"},te=m("查看"),se=m("标签"),ue={class:"btn-bottom oe-flex oe-flex-wrap"},oe=m("等级"),ne=m("黑名单"),ie={class:"oe-flex oe-row-between e-grid"},re={class:"operation-text"},de=m("全选当前页"),ce=m("加入黑名单"),ve=m("取消黑名单"),me=m("标签组"),pe=m("等级");f();var ge=e({expose:[],setup(e){const g=h(),{pagination:b,handleSizeChange:f,handleCurrentChange:ge}=x(),be=l(),fe=w();l([new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)]);const _e=l({keyWord:"",memberTag:"",source:"",level:"",balance:["",""],blacklist:"",registrationTime:"",consumptionTime:"",visitTime:"",integral:["",""]}),he=l(""),xe=l(!1),we=l([]),ke=l({}),ye=l(!1),Ve=l(0),Ce=l({label:!1,grade:!1,black:!1}),Te=l({registration:["",""],consumption:["",""],visit:["",""]}),Se=l([]),Ue=l(!1),je=l([]),ze=l([]),Le=l([]),Ie=l([]),Me=()=>{xe.value=!0,Ce.value.label=!0},Fe=()=>{xe.value=!0,Ce.value.grade=!0},Pe=e=>{e.id?(ke.value=e,ye.value=!1):ye.value=!0,Ve.value=0,Ce.value.black=!0},Be=()=>{Ve.value=1,ye.value=!0,Ce.value.black=!0},We=()=>{Se.value.length?Ue.value=!0:Ue.value=!1},Ke=()=>{b.currentPage=1,qe()};T({page:1,limit:100}).then((e=>{je.value=e.data.data.data})),S({page:1,limit:100}).then((e=>{ze.value=e.data.data.data})),U({page:1,limit:100}).then((e=>{Le.value=e.data.data.data}));const qe=async()=>{const e={keyword:_e.value.keyWord};_e.value.memberTag=he,(_e.value.balance[0]||_e.value.balance[1])&&(e.money=_e.value.balance),(Te.value.registration[0]||Te.value.registration[1])&&(e.jointime=Te.value.registration),(Te.value.consumption[0]||Te.value.consumption[1])&&(e.last_consumption_time=Te.value.consumption),(Te.value.visit[0]||Te.value.visit[1])&&(e.prevtime=Te.value.visit),(_e.value.integral[0]||_e.value.integral[1])&&(e.score=_e.value.integral),_e.value.memberTag&&(e.shop_user_label_id=[_e.value.memberTag]),_e.value.source&&(e.user_channel_id=[_e.value.source]),_e.value.level&&(e.shop_user_level_id=[_e.value.level]),""!=_e.value.blacklist&&(e.status=_e.value.blacklist);const l={search:"",page:b.currentPage,limit:b.pageSize};l.search=JSON.stringify(e);const{data:a}=await L(l);Ie.value=a.data.data;for(let t=0;t<Ie.value.length;t++)for(let e=0;e<je.value.length;e++)Ie.value[t].user_channel_id==je.value[e].id&&(Ie.value[t].img_url=je.value[e].img_url);b.total=a.data.total},De=()=>{_e.value.keyWord="",_e.value.memberTag="",_e.value.source="",_e.value.level="",_e.value.balance=["",""],_e.value.blacklist="",_e.value.registrationTime="",_e.value.consumptionTime="",_e.value.visitTime="",_e.value.integral=["",""],Te.value.consumption=["",""],Te.value.registration=["",""],Te.value.visit=["",""],b.currentPage=1,qe()},Ne=(e,l)=>{const a=_(e[0]).unix().toString(),t=_(e[1]).unix().toString();0==l?Te.value.registration=[a,t]:1==l?Te.value.consumption=[a,t]:Te.value.visit=[a,t]},Re=e=>{var l,a;e&&Se.value?1==e&&(null==(a=be.value)||a.toggleAllSelection()):null==(l=be.value)||l.clearSelection()},Ae=e=>{Se.value=e};return a(Se,(()=>{Se.value.length==Ie.value.length?Ue.value=!0:Ue.value=!1})),a([()=>b.currentPage,()=>b.pageSize],(()=>{qe()})),t((()=>{fe.query.id&&(he.value=Number(fe.query.id)),qe()})),I(((e,l)=>{const a=s("el-input"),t=s("el-form-item"),_=s("el-col"),h=s("el-option"),x=s("el-select"),w=s("el-date-picker"),T=s("el-button"),S=s("el-row"),U=s("el-form"),L=s("el-card"),fe=s("el-empty"),he=s("el-table-column"),Te=s("el-image"),Ee=s("el-tag"),Ge=s("custom-button"),Je=s("el-table"),Oe=s("el-checkbox"),Xe=s("el-link"),Ze=s("el-pagination");return u(),o(i,null,[n(L,{shadow:"never",class:"management-head"},{default:I((()=>[n(U,{model:_e.value,"label-width":"100px"},{default:I((()=>[n(S,{gutter:20},{default:I((()=>[n(_,{xl:{span:"4_8"},lg:8,md:12,sm:12,xs:12},{default:I((()=>[n(t,{label:"关键词"},{default:I((()=>[n("div",M,[n(a,{onInput:Ke,modelValue:_e.value.keyWord,"onUpdate:modelValue":l[1]||(l[1]=e=>_e.value.keyWord=e),class:"oe-flex-1",placeholder:"手机号/微信昵称/姓名"},null,8,["modelValue"])])])),_:1})])),_:1}),n(_,{xl:{span:"4_8"},lg:8,md:12,sm:12,xs:12},{default:I((()=>[n(t,{label:"会员标签"},{default:I((()=>[n("div",F,[n(x,{modelValue:_e.value.memberTag,"onUpdate:modelValue":l[2]||(l[2]=e=>_e.value.memberTag=e),placeholder:"全部",class:"oe-flex-1",clearable:""},{default:I((()=>[(u(!0),o(i,null,r(Le.value,(e=>(u(),o(h,{key:e.name,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])),_:1})])),_:1}),n(_,{xl:{span:"4_8"},lg:8,md:12,sm:12,xs:12},{default:I((()=>[n(t,{label:"来源渠道"},{default:I((()=>[n("div",P,[n(x,{modelValue:_e.value.source,"onUpdate:modelValue":l[3]||(l[3]=e=>_e.value.source=e),placeholder:"全部",class:"oe-flex-1",clearable:""},{default:I((()=>[(u(!0),o(i,null,r(je.value,(e=>(u(),o(h,{key:e.name,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])),_:1})])),_:1}),n(_,{xl:{span:"4_8"},lg:8,md:12,sm:12,xs:12},{default:I((()=>[n(t,{label:"会员等级"},{default:I((()=>[n("div",B,[n(x,{modelValue:_e.value.level,"onUpdate:modelValue":l[4]||(l[4]=e=>_e.value.level=e),placeholder:"全部",class:"oe-flex-1",clearable:""},{default:I((()=>[(u(!0),o(i,null,r(ze.value,(e=>(u(),o(h,{key:e.level_name,label:e.level_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])),_:1})])),_:1}),n(_,{xl:{span:"4_8"},lg:8,md:12,sm:12,xs:12},{default:I((()=>[n(C,{onKeyup:d(Ke,["enter"]),modelValue:_e.value.balance,"onUpdate:modelValue":l[5]||(l[5]=e=>_e.value.balance=e),company:"元",titleTetx:"余额"},null,8,["onKeyup","modelValue"])])),_:1}),n(_,{xl:{span:"4_8"},lg:8,md:12,sm:12,xs:12},{default:I((()=>[n(t,{label:"黑名单"},{default:I((()=>[n("div",W,[n(x,{modelValue:_e.value.blacklist,"onUpdate:modelValue":l[6]||(l[6]=e=>_e.value.blacklist=e),placeholder:"全部",class:"oe-flex-1",clearable:""},{default:I((()=>[n(h,{label:"是",value:"2"}),n(h,{label:"否",value:"1"})])),_:1},8,["modelValue"])])])),_:1})])),_:1}),n(_,{xl:{span:"4_8"},lg:8,md:12,sm:12,xs:12},{default:I((()=>[n(t,{label:"注册日期"},{default:I((()=>[n("div",K,[n(w,{class:"oe-flex-1",modelValue:_e.value.registrationTime,"onUpdate:modelValue":l[7]||(l[7]=e=>_e.value.registrationTime=e),type:"datetimerange",onChange:l[8]||(l[8]=e=>Ne(e,0)),"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])])])),_:1})])),_:1}),n(_,{xl:{span:"4_8"},lg:8,md:12,sm:12,xs:12},{default:I((()=>[n(t,{label:"上次消费时间"},{default:I((()=>[n("div",q,[n(w,{class:"oe-flex-1",onChange:l[9]||(l[9]=e=>Ne(e,1)),modelValue:_e.value.consumptionTime,"onUpdate:modelValue":l[10]||(l[10]=e=>_e.value.consumptionTime=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])])])),_:1})])),_:1}),n(_,{xl:{span:"4_8"},lg:8,md:12,sm:12,xs:12},{default:I((()=>[n(t,{label:"上次访问时间"},{default:I((()=>[n("div",D,[n(w,{onChange:l[11]||(l[11]=e=>Ne(e,2)),class:"oe-flex-1",modelValue:_e.value.visitTime,"onUpdate:modelValue":l[12]||(l[12]=e=>_e.value.visitTime=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])])])),_:1})])),_:1}),n(_,{xl:{span:"4_8"},lg:8,md:12,sm:12,xs:12},{default:I((()=>[n(C,{onKeyup:d(Ke,["enter"]),modelValue:_e.value.integral,"onUpdate:modelValue":l[13]||(l[13]=e=>_e.value.integral=e),company:"分",titleTetx:"积分"},null,8,["onKeyup","modelValue"])])),_:1}),n(_,{xl:{span:"4_8"},lg:8,md:12,sm:12,xs:12},{default:I((()=>[n("div",N,[n(T,{type:"primary",onClick:Ke},{default:I((()=>[R])),_:1}),n("div",{onClick:De,class:"reset-text"},"重置条件")])])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),n(L,{shadow:"never",class:"custom-crad-container custom-card-page"},{default:I((()=>[n(Je,{ref:be,class:"table-box","cell-style":{background:"#fff"},data:Ie.value,style:{width:"100%"},onSelectAll:We,onSelectionChange:Ae},{empty:I((()=>[n(fe,{class:"oe-m-t-30",description:"暂无会员"})])),default:I((()=>[n(he,{type:"selection",width:"55"}),n(he,{label:"会员昵称","min-width":"160",prop:"date"},{default:I((e=>[n("div",A,[n(Te,{src:e.row.avatar,fit:"cover",class:"Member-name-img"},null,8,["src"]),n("div",null,[n("div",E,c(e.row.nickname),1),n("div",G,[n(Te,{src:e.row.img_url,class:"name-icon"},null,8,["src"]),2==e.row.status?(u(),o("div",J,"黑名单")):v("",!0)])])])])),_:1}),n(he,{prop:"mobile","min-width":"100",label:"手机号"}),n(he,{prop:"address",label:"等级","min-width":"90"},{default:I((e=>[m(c(e.row.current_shop_user_level_name),1)])),_:1}),n(he,{prop:"address",label:"标签组","min-width":"140"},{default:I((e=>[n("div",O,[(u(!0),o(i,null,r(e.row.user_labels,((e,l)=>(u(),o(Ee,{type:"warning",size:"mini",key:Number(l)},{default:I((()=>[m(c(e.label_name),1)])),_:2},1024)))),128))])])),_:1}),n(he,{prop:"address",label:"成交","min-width":"100"},{default:I((e=>[n("div",null,[X,n("span",Z,c(e.row.total_order_nums),1)]),n("div",null,[H,n("span",Q,c(e.row.total_order_money),1)])])),_:1}),n(he,{prop:"address",label:"余额/积分","min-width":"85"},{default:I((e=>[n("div",null,[Y,n("span",$,c(e.row.total_score),1)]),n("div",null,[ee,n("span",le,c(e.row.money),1)])])),_:1}),n(he,{prop:"jointime",label:"注册时间","min-width":"160"}),n(he,{prop:"address",label:"操作","min-width":"160"},{default:I((e=>[n("div",ae,[n(Ge,{icon:"ad-see",color:"#FE6712",onClick:l=>{return a=e.row,void g.push({path:"/member/member-details",query:{id:a.id}});var a},class:"public-move-right"},{default:I((()=>[te])),_:2},1032,["onClick"]),n(Ge,{icon:"ad-label",color:"#FE6712",onClick:l=>(async e=>{xe.value=!1;const{data:l}=await j({id:e.id,status:-1});ke.value=e,we.value=l.data.label_list,Ce.value.label=!0})(e.row)},{default:I((()=>[se])),_:2},1032,["onClick"])]),n("div",ue,[n(Ge,{icon:"ad-grade",color:"#2DB6F5",onClick:l=>(async e=>{xe.value=!1;const{data:l}=await z({id:e.id,status:-1});ke.value=e,we.value=l.data.current_level,Ce.value.grade=!0})(e.row),class:"public-move-right"},{default:I((()=>[oe])),_:2},1032,["onClick"]),"2"!=e.row.status?(u(),o(Ge,{key:0,icon:"ad-blacklist",color:"#FF0000",onClick:l=>Pe(e.row)},{default:I((()=>[ne])),_:2},1032,["onClick"])):v("",!0)])])),_:1})])),_:1},8,["data"]),n(S,{gutter:24,style:{margin:"0"},class:"oe-flex oe-row-between order-bottom"},{default:I((()=>[n(_,{lg:12},{default:I((()=>[n("div",ie,[n("div",re,[n(Oe,{modelValue:Ue.value,"onUpdate:modelValue":l[14]||(l[14]=e=>Ue.value=e),onChange:Re},{default:I((()=>[de])),_:1},8,["modelValue"]),n(Xe,{href:"javascript:;",underline:!1,class:[{"public-red":Se.value.length},"public"],disabled:!Se.value.length,onClick:Pe},{default:I((()=>[ce])),_:1},8,["class","disabled"]),n(Xe,{href:"javascript:;",underline:!1,class:[{"public-red":Se.value.length},"public"],onClick:Be,disabled:!Se.value.length},{default:I((()=>[ve])),_:1},8,["class","disabled"]),n(Xe,{href:"javascript:;",underline:!1,class:[{"public-red":Se.value.length},"public"],disabled:!Se.value.length,onClick:Me},{default:I((()=>[me])),_:1},8,["class","disabled"]),n(Xe,{href:"javascript:;",onClick:Fe,underline:!1,class:[{"public-red":Se.value.length},"public"],disabled:!Se.value.length},{default:I((()=>[pe])),_:1},8,["class","disabled"])])])])),_:1}),n(_,{lg:12},{default:I((()=>[n(Ze,{class:"e-grid","page-sizes":p(b).pageSizes,"page-size":p(b).pageSize,onSizeChange:p(f),onCurrentChange:p(ge),background:"","current-page":p(b).currentPage,layout:"total, prev, pager, next,sizes, jumper",total:p(b).total},null,8,["page-sizes","page-size","onSizeChange","onCurrentChange","current-page","total"])])),_:1})])),_:1})])),_:1}),n(k,{show:Ce.value.black,"onUpdate:show":l[15]||(l[15]=e=>Ce.value.black=e),currentItem:ke.value,selectList:Se.value,isSingle:Ve.value,isMultiple:ye.value,onResetManagementList:qe},null,8,["show","currentItem","selectList","isSingle","isMultiple"]),n(y,{show:Ce.value.grade,"onUpdate:show":l[16]||(l[16]=e=>Ce.value.grade=e),currentGrade:we.value,selectList:Se.value,isBatch:xe.value,currentItem:ke.value,onResetManagementList:qe},null,8,["show","currentGrade","selectList","isBatch","currentItem"]),n(V,{show:Ce.value.label,"onUpdate:show":l[17]||(l[17]=e=>Ce.value.label=e),selectList:Se.value,isBatch:xe.value,currentList:we.value,currentItem:ke.value,onResetManagementList:qe},null,8,["show","selectList","isBatch","currentList","currentItem"])],64)}))}});ge.__scopeId="data-v-5bbcabd0";export default ge;
